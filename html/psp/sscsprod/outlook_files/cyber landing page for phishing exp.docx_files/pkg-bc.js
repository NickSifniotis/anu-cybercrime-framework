(function(){define("modules/dirty/browse/show_share_buttons",["dropbox","jquery","modules/clean/browse_events","modules/clean/viewer"],function(e,t,r,s){var o,a,n;return o=e.FileOps,n=function(e){return null==e&&(e=!1),e?t(document).one(r.RENDER,function(){return a()}):a()},a=function(){var e,r;return r=t(".sharing__actions"),0===r.length?void o.show_upload():(r.show(),e=t(".inline-share-button"),e.hasClass("pulse")&&(e.removeClass("pulse"),e[0].offsetWidth=e[0].offsetWidth),e.addClass("pulse"),e.on("click.removePulse",function(){return e.css("display","").removeClass("pulse"),e.off(".removePulse")}))},n})}).call(this),function(){define("modules/dirty/react/growth/experiments/onboarding_progress_bar",["external/classnames","external/react","jquery","dropbox","modules/core/i18n","modules/core/uri","modules/clean/account/email_verify_reasons","modules/clean/react/button","modules/clean/react/react_i18n","modules/clean/ajax","modules/clean/viewer","modules/clean/account/email","modules/clean/profile_services/profile_services_constants","modules/clean/profile_services/profile_services_link","modules/clean/growth/experiments/logger","modules/clean/react/file_uploader/uploader","modules/clean/sharing/ui_util","modules/clean/static_urls","modules/constants/browse","modules/dirty/browse/show_share_buttons"],function(e,t,r,s,o,a,n,i,c,l,p,d,g,h,u,_,m,f,b,w){var x,k,v,T,I,N,y,D,E,j,S,C,O,A,P,R;return x=s.Browse,T=s.FileOps,E=s.SharingModals,k=s.CreateOrShareNewFolderWizardModal,S=o._,C=i.button,D=c.R_,v=d.EmailVerification,y=h.ProfileServicesLinkingHandler,I=_.FileUploader,j=m.Tiburon,R=f.static_url,A=t.DOM,O=t.createElement,P=function(){return b.BROWSE_IN_REACT?I.showModal():T.show_upload()},N=t.createClass({displayName:"GrowthOnboardingProgressBar",POLL_INTERVAL_SECS:5,MAX_NUMBER_OF_POLLS:60,ONBOARDING_PROGRESS_BAR_HEIGHT:230,ONBOARDING_PROGRESS_BAR_COLLAPSED_HEIGHT:60,TASK_INFO:{COMPLETE:{image:R("/static/images/cupcake-vflQp9omo.png"),title:S("Great job! You’re now a Dropbox expert!",{project:"growth-exps"}),shortTitle:S("Great job!",{project:"growth-exps"}),description:S("You now know how to add files to your Dropbox and share them with others. If you need help, just click the “Help” link at the lower left for more info.",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Got it!",{project:"growth-exps"}),ctaAction:function(e){return u.log("onboarding","close_progress_bar",{},"bar_view_time"),e.setState({showProgressbar:!1})}},ADD_CONTACTS:{image:R("/static/images/growth/experiments/progress_add_contacts-vflbBLwV1.png"),title:S("Add contacts",{project:"growth-exps"}),description:S("Sharing is easier when you add your contacts on Dropbox.",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Add Gmail contacts",{project:"growth-exps"}),ctaAction:function(e){var t;return t=new y,t.auth_service_with_user(g.GOOGLE,e.getUserID(),function(e){return y.show_import_notifications(e)},"progress_bar")}},CREATE_FOLDER:{image:R("/static/images/growth/experiments/progress_make_folder-vflprSZli.png"),title:S("Create a folder",{project:"growth-exps"}),description:S("Folders are a great way to organize your files. You can also invite people to a folder to work on the same files together.",{project:"growth-exps",comment:"Please keep underxz 230 characters"}),ctaText:S("Create a folder",{project:"growth-exps"}),ctaAction:function(){return x.new_folder()}},CREATE_SHARED_FOLDER:{image:R("/static/images/growth/experiments/progress_invite_shared_folder-vfliOdqGO.png"),title:S("Invite collaborators to a shared folder",{project:"growth-exps"}),shortTitle:S("Invite collaborators",{project:"growth-exps"}),description:S("Tired of emailing files back and forth? Invite people to a Dropbox shared folder instead. When someone makes changes to a file, everyone instantly gets the latest version.",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Share a folder",{project:"growth-exps"}),ctaAction:function(e){var t,r;return r=e.getUser(),v.get_for_user(r).verified_or_show(n.SHARE_FOLDER)?j.foldersUI(r)?E.show_shared_folder_wizard(r):(t=new k(x.active_user,{element_id:"create-and-share-new-folder-modal-"+r,destination_dir:x.containing_fq_path()}),t.show()):void 0}},CREATE_SHARED_LINK:{image:R("/static/images/growth/experiments/progress_share_file-vflRYw3o1.png"),title:S("Share a link to a file",{project:"growth-exps"}),shortTitle:S("Share a link",{project:"growth-exps"}),description:S("Need to send a large file, video, or a bunch of photos? Just copy the Dropbox link and paste it into an email, chat, text message…you name it. It’s that easy!",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Share a link",{project:"growth-exps"}),ctaAction:function(){return w()}},LINK_DESKTOP_CLIENT:{image:R("/static/images/growth/experiments/progress_link_client-vflgFQqAv.png"),title:S("Install Dropbox on your computer",{project:"growth-exps"}),shortTitle:S("Install Dropbox",{project:"growth-exps"}),description:S("Access your files faster by installing the Dropbox app on your computer.  %(referral_message)s",{project:"growth-exps",comment:"Please keep under 230 characters. Note that referral_message is another sentence."}),descriptionFill:function(e){return{referral_message:e.referralMessage}},ctaText:S("Download Dropbox",{project:"growth-exps"}),ctaAction:function(){return window.open("/downloading","_blank")}},LINK_MOBILE_CLIENT:{image:R("/static/images/growth/experiments/progress_link_mobile-vflx8ond7.png"),title:S("Take your docs anywhere",{project:"growth-exps"}),shortTitle:S("Get mobile app",{project:"growth-exps"}),description:S("Save files on your computer, then access them on your phone from the road.",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Download the Dropbox mobile app",{project:"growth-exps"}),ctaAction:function(){return window.open("/mobile","_blank")}},REFER_FRIENDS:{image:R("/static/images/growth/experiments/progress_invite_friends-vflcXvE1J.png"),title:S("Invite friends and earn space",{project:"growth-exps"}),shortTitle:S("Invite friends",{project:"growth-exps"}),description:S("For every friend who joins and installs Dropbox, we’ll give you both %(bonus)s of bonus space (up to %(max_bonus)s).",{project:"growth-exps",comment:"Please keep under 230 characters"}),descriptionFill:function(e){return{bonus:e.props.referralBonuses[0],max_bonus:e.props.referralBonuses[1]}},ctaText:S("Invite friends",{project:"growth-exps"}),ctaAction:function(e){var t;return t=v.get_for_user(e.getUser()),t.verified_or_send_and_show(n.REFER_FRIENDS,function(){return window.open("/referrals","_blank")})}},UPLOAD_FIRST_FILE:{image:R("/static/images/growth/experiments/progress_add_files-vflaza3My.png"),title:S("Add a file",{project:"growth-exps"}),titleFill:function(e){var t;return t=S("Add a file",{project:"growth-exps"}),"V1"===e.props.expSubgrowthBasicProgressBarVerifyImage&&(t=S("Keep your files safe",{project:"growth-exps"})),t},description:S("Any file you add to Dropbox is safely backed up so you’ll never lose another presentation or vacation memory.",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Add a file",{project:"growth-exps"}),ctaAction:function(){return P()}},UPLOAD_MORE_THAN_ONE_FILE:{image:R("/static/images/growth/experiments/progress_add_files-vflaza3My.png"),title:S("Add another file",{project:"growth-exps"}),description:S("The more, the merrier! Make sure all the files, photos, and videos you care about are safely backed up on Dropbox.",{project:"growth-exps",comment:"Please keep under 230 characters"}),ctaText:S("Add more files",{project:"growth-exps"}),ctaAction:function(){return P()}},VERIFY_EMAIL:{image:function(e){return e},imageFill:function(e){var t,r;return r=R("/static/images/growth/experiments/progress_verify_email-vflO7vE8i.png"),t="V1"===e.props.expSubgrowthBasicProgressbarVerifyImage,"V1"===e.props.expSubgrowthBasicProgressbarVerifyImage&&(r=R("/static/images/growth/experiments/exp_progress_verify_email_v1-vflNJCFVC.jpg")),{image:r,imageFillNeeded:t}},title:S("Verify your email",{project:"growth-exps"}),description:S("To start sharing and using all of Dropbox’s features, verify your account—we do this for your security. %(referral_message)s",{project:"growth-exps",comment:"Please keep under 230 characters. Note that referral_message is another sentence."}),ctaText:S("Verify my email",{project:"growth-exps"}),descriptionFill:function(e){return{referral_message:e.referralMessage}},ctaAction:function(e){var t;return t=v.get_for_user(e.getUser()),t.send_email(v.reason,function(){return t.email_sent(function(){})})}}},propTypes:{initialDataDict:t.PropTypes.object,userId:t.PropTypes.number,referralBonuses:t.PropTypes.array,expGrowthProgressBarCta:t.PropTypes.string,expGrowthProgressBarAddFile:t.PropTypes.string,expSubgrowthBasicProgressBarVerifyImage:t.PropTypes.string},getInitialState:function(){var e,t;return e=this.props.initialDataDict,this.pollID=0,{collapsed:(null!=(t=e.extra)?t.is_collapsed:void 0)||!1,dataDict:e,buttonDisabled:!1,currentIndex:this.getUpdatedIndex(e.tasks),showProgressbar:!0}},logViewTask:function(){return u.set_start_time("task_view_time"),u.log("onboarding","view_progress_bar_step",{object:"progress_bar_task_"+this.currentTaskName.toLowerCase(),collapsed:this.state.collapsed,tasks_left:this.state.dataDict.incompleteTaskCount},"bar_view_time")},componentDidUpdate:function(e,t){return t.currentIndex!==this.state.currentIndex?this.logViewTask():void 0},componentDidMount:function(){return u.set_start_time("bar_view_time"),u.log("onboarding","view_progress_bar",{collapsed:this.state.collapsed,tasks_left:this.state.dataDict.incompleteTaskCount}),this.logViewTask()},saveCollapsedState:function(e){return l.WebRequest({url:"/growth/progress_bar/set_collapsed_state",subject_user:this.getUserID(),dataType:"json",data:{is_collapsed:e},success:this.maybeUpdateStateFromServer})},getUpdatedIndex:function(e){var t,r,s,o,a;for(t=s=0,o=e.length;o>=0?o>s:s>o;t=o>=0?++s:--s)if(r=(t+((null!=(a=this.state)?a.currentIndex:void 0)||0))%e.length,"COMPLETE"!==e[r].status)return r;return-1},pollForTaskCompletion:function(e,t){var r;if(!(e!==this.pollID||t>=this.MAX_NUMBER_OF_POLLS||-1===(null!=(r=this.state)?r.currentIndex:void 0)))return window.setTimeout(function(r){return function(){return r.pollForTaskCompletion(e,t+1)}}(this),1e3*this.POLL_INTERVAL_SECS),l.WebRequest({url:"/growth/progress_bar/current_state",subject_user:this.getUserID(),dataType:"json",success:this.maybeUpdateStateFromServer})},maybeUpdateStateFromServer:function(e){return JSON.stringify(this.state.dataDict)!==JSON.stringify(e)?(this.state.dataDict.tasks[this.state.currentIndex].status!==e.tasks[this.state.currentIndex].status&&u.log("onboarding","complete_progress_bar_step",{object:"progress_bar_task_"+this.currentTaskName.toLowerCase()},"task_view_time"),this.setState({dataDict:e,currentIndex:this.getUpdatedIndex(e.tasks)})):void 0},getUserID:function(){return this.props.userId},getUser:function(){return p.get_viewer().get_user_by_id(this.getUserID())},collapseBar:function(){var e,t,s;return u.log("onboarding","collapse_progress_bar",{object:"progress_bar_task_"+this.currentTaskName.toLowerCase()},"task_view_time"),this.saveCollapsedState(!0),s=this.ONBOARDING_PROGRESS_BAR_HEIGHT,t=this.ONBOARDING_PROGRESS_BAR_COLLAPSED_HEIGHT,e=r(this.getDOMNode()),this.setState({collapsed:!0},function(){return e.find(".growth-onboarding-progress-bar__inner").hide().fadeIn(),e.css({height:s}).animate({height:t},function(){return e.css({height:""}),e.find(".growth-onboarding-progress-bar__inner").css({display:""})})})},expandBar:function(e){var t,s,o;return s=r(e.target).hasClass("growth-onboarding-progress-bar__step-description"),u.log("onboarding","expand_progress_bar",{object:"progress_bar_task_"+this.currentTaskName.toLowerCase(),action_detail:s?"click_link":"click_bar"},"task_view_time"),this.saveCollapsedState(!1),o=this.ONBOARDING_PROGRESS_BAR_HEIGHT,t=r(this.getDOMNode()),t.find(".growth-onboarding-progress-bar__inner").fadeOut(),t.animate({height:o},function(e){return function(){return e.setState({collapsed:!1},function(){return t.css({height:""}),t.find(".growth-onboarding-progress-bar__inner").css({display:""}),t.find(".growth-onboarding-progress-bar__close-x").css({display:""})})}}(this))},getExpTitle:function(){var e,t;return e="This is the header for a progress bar that teaches the user how to take important actions on Dropbox, like uploading a file or sharing a folder. This needs to fit into a small space, so a short translation is preferred.",t="growth-exps","V1"===this.props.expGrowthProgressBarCta?S("Become A Dropbox Master",{comment:e,project:t}):"V2"===this.props.expGrowthProgressBarCta?S("Get The Most Out Of Dropbox",{comment:e,project:t}):S("Dropbox Mastery",{comment:e,project:t})},render:function(){return this.state.showProgressbar?(r("body").toggleClass("has-top-onboarding-progress-bar",!this.state.collapsed),r("body").toggleClass("has-top-onboarding-progress-bar-collapsed",this.state.collapsed),this.currentTaskName=-1===this.state.currentIndex?"COMPLETE":this.state.dataDict.tasks[this.state.currentIndex].taskName,this.currentTaskInfo=this.TASK_INFO[this.currentTaskName],this.showCompleted=-1!==this.state.currentIndex&&"COMPLETE"===this.state.dataDict.tasks[this.state.currentIndex].status,this.referralMessage=this.showCompleted?"":this.state.dataDict.referralMessage,this.state.collapsed?this.renderCollapsed():this.renderExpanded()):A.div({})},renderExpanded:function(){var e;return A.div({className:"growth-onboarding-progress-bar__outer expanded","data-task-name":this.currentTaskName},A.div({className:"growth-onboarding-progress-bar__close-x",onClick:this.collapseBar},S("Minimize",{comment:"Collapses a banner to take up less space",project:"growth-exps"})),A.div({className:"growth-onboarding-progress-bar__inner"},A.div({className:"growth-onboarding-progress-bar__header clearfix"},A.div({className:"growth-onboarding-progress-bar__title"},this.getExpTitle()),this.renderProgressIndicator()),A.div({className:"growth-onboarding-progress-bar__body clearfix"},A.div({className:"growth-onboarding-progress-bar__image "+(null!=this.currentTaskInfo.imageFill&&this.currentTaskInfo.imageFill(this).imageFillNeeded===!0?"growth-onboarding-progress-bar__image-fill":"")},null!=this.currentTaskInfo.imageFill?(e=this.currentTaskInfo.image(this.currentTaskInfo.imageFill(this).image),A.img({alt:"",src:e})):A.img({alt:"",src:this.currentTaskInfo.image})),A.div({className:"growth-onboarding-progress-bar__step"},A.div({className:"growth-onboarding-progress-bar__step-name"},null!=this.currentTaskInfo.titleFill?this.currentTaskInfo.titleFill(this):this.currentTaskInfo.title),A.div({className:"growth-onboarding-progress-bar__step-description"},null!=this.currentTaskInfo.descriptionFill?this.currentTaskInfo.description.format(this.currentTaskInfo.descriptionFill(this)):this.currentTaskInfo.description),A.div({className:"growth-onboarding-progress-bar__step-buttons"},"VERIFY_EMAIL"===this.currentTaskName&&this.showCompleted?void 0:O(C,{className:"growth-onboarding-progress-bar__step-cta",disabled:this.state.buttonDisabled,onClick:function(e){return function(){return u.log("onboarding","click_progress_bar_step",{object:"progress_bar_task_"+e.currentTaskName.toLowerCase()},"task_view_time"),e.setState({buttonDisabled:!0}),e.pollForTaskCompletion(++e.pollID,0),e.currentTaskInfo.ctaAction(e),window.setTimeout(function(){return e.setState({buttonDisabled:!1})},2e3)}}(this)},this.currentTaskInfo.ctaText),this.showCompleted?A.div({className:"onboarding-progress-bar__complete_text"},S("Complete!",{project:"growth-exps"})):"REFER_FRIENDS"===this.currentTaskName&&this.state.dataDict.showInvitationSent?A.div({className:"onboarding-progress-bar__invitation_sent",onClick:function(){return window.open("/account/bonus","_blank")}},S("Invitation sent!",{project:"growth-exps"})):void 0)))))},renderCollapsed:function(){return A.div({className:"growth-onboarding-progress-bar__outer collapsed","data-task-name":this.currentTaskName,onClick:this.expandBar},A.div({className:"growth-onboarding-progress-bar__inner clearfix"},A.div({className:"growth-onboarding-progress-bar__left"},A.div({className:"growth-onboarding-progress-bar__title"},this.getExpTitle()),this.renderProgressIndicator()),A.div({className:"growth-onboarding-progress-bar__right"},D({step_description:this.currentTaskInfo.shortTitle||this.currentTaskInfo.title},"<span class='growth-onboarding-progress-bar__step-label'>Next step:</span> <span class='growth-onboarding-progress-bar__step-description'>%(step_description)s &#9662;</span>"))))},renderProgressIndicator:function(){var e,t;return A.div({className:"onboarding-progress-bar__progress-circles"},function(){var r,s,o,a;for(o=this.state.dataDict.tasks,a=[],e=r=0,s=o.length;s>r;e=++r)t=o[e],a.push(this.renderProgressIndicatorCircle(t,e));return a}.call(this))},renderProgressIndicatorCircle:function(t,r){return t.taskName in this.TASK_INFO?A.div({className:e({"onboarding-progress-bar__progress-circle":!0,"is-selected":this.state.currentIndex===r,"is-incomplete":"COMPLETE"!==t.status}),key:r,onClick:function(e){return function(){return e.state.currentIndex!==r?(e.setState({currentIndex:r}),e.pollForTaskCompletion(++e.pollID,0)):void 0}}(this)},A.div({className:"onboarding-progress-bar__progress-circle-container"},A.div({className:"onboarding-progress-bar__progress-circle-desc"},this.TASK_INFO[t.taskName].ctaText))):A.span({key:r})}}),{GrowthOnboardingProgressBar:N}})}.call(this);
//# sourceMappingURL=pkg-bc.min.js-vflsA4qhH.map