(function(){define("modules/clean/groups/add_group_members_modal",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/groups/group_members_form","modules/clean/viewer"],function(e,t,s,n,a,o,r,i){var l,u,m,c,d,p,h;return m=s._,p=s.ungettext,u=o.Modal,c=t.DOM,d=t.PropTypes,h=i.get_viewer(),l=t.createClass({displayName:"AddGroupMembersModal",propTypes:{group:d.object,onGroupChanged:d.func,isWebActionsAsync:d.bool},getInitialState:function(){return{canProceed:!1,submitting:!1}},componentDidMount:function(){return e(".contacts-tokenizer-input").select()},_canProceed:function(){var e,t;return(null!=(e=this.refs.members)?e.areAllContactsValid():void 0)&&!(null!=(t=this.refs.members)?t.isEmpty():void 0)},onClickAddMembers:function(e){return e.preventDefault(),this.refs.members.getFinalData(function(e){return function(t){var s,o;return o=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s?(e.setState({submitting:!0}),a.WebRequest({url:"/groups_ajax/add_users_to_group",data:{members:JSON.stringify(o),group_id:e.props.group.id},subject_user:h.work_user,complete:function(){return e.isMounted()?e.setState({submitting:!1}):void 0},success:function(t){return t=JSON.parse(t),null===t.data?n.success(p("Member added.","Members added.",o.length)):n.success(p("Adding member...","Adding members...",o.length)),u.close(),e.props.onGroupChanged(!0,null)}})):void 0}}(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return t.createElement(u,{title:m("Add members to “%(group_name)s”").format({group_name:this.props.group.name}),acceptButtonText:m("Add members"),dismissButtonText:m("Cancel"),onAccept:this.onClickAddMembers,acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,ref:"modal"},t.createElement(r,{ref:"members",group:this.props.group,user:h.work_user,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:m("Add names or emails"),disallowNonGroupMembers:!1,disallowGroupMembers:!0}),this.props.isWebActionsAsync?c.label({},c.br({}),m("Giving new members access to all of this group’s shared folders might take a little while.")):void 0)}})})}).call(this),function(){define("modules/clean/groups/change_group_name_modal",["external/react","modules/core/i18n","modules/clean/ajax","modules/clean/react/modal","modules/clean/react/input","modules/clean/viewer","modules/clean/groups/constants"],function(e,t,s,n,a,o,r){var i,l,u,m,c,d,p;return m=t._,u=n.Modal,l=r.MAX_GROUP_NAME_LEN,c=e.DOM,d=e.PropTypes,p=o.get_viewer(),i=e.createClass({mixins:[e.addons.LinkedStateMixin],displayName:"ChangeGroupNameModal",propTypes:{origGroupName:d.string,groupId:d.string,onNameChanged:d.func},getInitialState:function(){return{newGroupName:"",submitting:!1,errors:null}},groupNameIsValid:function(){return this.state.newGroupName.length<=l},canProceed:function(){return!this.state.submitting&&""!==this.state.newGroupName.trim()&&this.groupNameIsValid()},getLocalError:function(){return this.groupNameIsValid()?void 0:{message_text:m("The group name should be under %(max_len)d characters").format({max_len:l})}},onSubmit:function(e){return null!=e&&e.preventDefault(),this.canProceed()&&!this.state.submitting?(this.setState({submitting:!0}),s.WebRequest({url:"/groups_ajax/rename_group",data:{group_id:this.props.groupId,new_name:this.state.newGroupName},subject_user:p.work_user,error:function(e){return function(t,s,n){return e.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})}}(this),success:function(e){return function(t){return t=JSON.parse(t),e.props.onNameChanged(e.state.newGroupName),u.close()}}(this)})):void 0},render:function(){var t,s;return e.createElement(u,{className:"change-group-name-modal",title:m("Edit ‘%(group_name)s’").format({group_name:this.props.origGroupName}),acceptButtonText:m("Save changes"),dismissButtonText:m("Cancel"),acceptButtonDisabled:!this.canProceed(),submitting:this.state.submitting,onAccept:this.onSubmit,autoClose:!1},c.form({onSubmit:this.onSubmit},c.label({className:"label-description"},m("Group name"),e.createElement(a.text,{className:"group-name-input",placeholder:this.props.origGroupName,valueLink:this.linkState("newGroupName"),autofocus:!0,"error-after":!0,error:this.getLocalError()||(null!=(t=this.state.errors)?t.new_name:void 0)||(null!=(s=this.state.errors)?s.full_name:void 0)}))))}})})}.call(this),function(){define("modules/clean/groups/constants",[],function(){var e;return e=140,{MAX_GROUP_NAME_LEN:e}})}.call(this),function(){define("modules/clean/groups/group_member_list",["external/underscore","external/react","modules/core/i18n","modules/core/user_i18n","modules/core/notify","modules/clean/ajax","modules/clean/viewer","modules/clean/react/table","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/dbox_app_promo","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar_with_color","modules/clean/groups/simple_modals"],function(e,t,s,n,a,o,r,i,l,u,m,c,d,p){var h,g,f,_,b,v,y,w,C,M,N,T,S,A,k;return b=s._,A=s.ungettext,g=u.BubbleMenu,f=u.BubbleMenuItem,h=m.Actionable,M=p.showLeaveGroupModal,S=p.showRemoveUserModal,T=p.showRemoveOwnerPermissionsModal,N=p.showMakeOwnerModal,w=t.DOM,C=t.PropTypes,y=t.addons.classSet,k=r.get_viewer(),v=function(e,t){var s,n,a;n={};for(a in e)s=e[a],n[a]=s.bind(t);return n},_=t.createClass({displayName:"MemberList",propTypes:{group:C.object,canHaveAdminUi:C.bool,managedGroupsEnabled:C.bool,onGroupChanged:C.func,isWebActionsAsync:C.bool},viewerIsOwner:function(){return this.props.group.is_owner},canManageGroup:function(){return this.props.canHaveAdminUi||this.viewerIsOwner()},onRemoveUserSuccess:function(e){return this.removeMemberUser(e),this.refs.members.forceRefresh(),this.props.onGroupChanged(!1,this.props.group)},onClickRemoveUser:function(e){return e.user_id===k.work_user.id?M(this.props.group,this.props.isWebActionsAsync):S(this.props.group,e,this.onRemoveUserSuccess.bind(this),this.props.isWebActionsAsync)},onClickApproveJoinReq:function(e){return o.WebRequest({url:"/groups_ajax/approve",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:k.work_user,success:function(t){return function(s){return a.success(b("Request approved.")),t.convertPendingUserToMemberLocally(e),t.refs.members.forceRefresh(),t.props.onGroupChanged(!1,t.props.group)}}(this)})},onClickRemoveJoinReq:function(e){return o.WebRequest({url:"/groups_ajax/remove",data:{group_id:this.props.group.id,requesting_user_id:e.user_id},subject_user:k.work_user,success:function(t){return function(s){return a.success(b("Request removed.")),t.removePendingUser(e),t.refs.members.forceRefresh()}}(this)})},removeMemberUser:function(t){var s;return s=e.indexOf(this.props.group.users,t),s>-1?(this.props.group.users.splice(s,1),this.props.group.user_count-=1,this.props.group.owners=this.props.group.owners.filter(function(e){return e.email!==t.email})):void 0},removePendingUser:function(t){var s;return s=e.indexOf(this.props.group.pending_req_users,t),s>-1?this.props.group.pending_req_users.splice(s,1):void 0},convertPendingUserToMemberLocally:function(e){return this.removePendingUser(e),e.localized_joined_ts=b("Just now"),e.is_pending=!1,this.props.group.users.unshift(e),this.props.group.user_count+=1},localSortUsers:function(e,t){var s,n,a,o;return o=this.props.group.users.slice(0),n=function(e,t){return e.sort(function(e,s){return e[t]<s[t]?-1:e[t]>s[t]?1:0})},a=e.sortColumn,"localized_joined_ts"===a&&(a="joined_ts"),n(o,a),e.sortDir===i.DESC_DIR&&o.reverse(),s=this.buildMemberList(this.props.group.pending_req_users,o),t(null,{rows:s,total:s.length})},buildMemberList:function(e,t){return this.canManageGroup()?e.concat(t):t},columnTypes:{displayName:function(e){return{field:"name",header:b("Name"),classes:{"display-name-column":!0},width:e,render:function(e){return function(s){return w.span({},t.createElement(c,{dimension:24,photoUrl:s.photo_url,optionalClass:"u-mar-right-s u-mar-left-xs",defaultAvatar:t.createElement(d,{dimension:24,initials:n.getInitials(s.name||s.email),name:s.name,shape:"CIRCLE",optionalClass:"u-mar-right-s u-mar-left-xs"})}),w.span({className:"user-name"},w.span({className:y({pending:s.is_pending})},s.name?s.name:"-")),w.span({className:"user-status"},s.is_owner?e.props.managedGroupsEnabled?" · "+b("Manager"):" · "+b("Owner"):s.is_pending?" · "+b("Pending"):void 0))}}(this)}},userEmail:function(e){return{field:"email",header:b("Email"),classes:{"email-column":!0},width:e,render:function(e){return w.span({className:"user-email"},w.span({className:y({pending:e.is_pending})},e.email))}}},joinedDate:function(e){return{field:"localized_joined_ts",header:b("Joined"),width:e,render:function(e){return e.localized_joined_ts}}},settings:function(e){return{width:e,classes:{"settings-column":!0},render:function(e){return function(s){var n,a,o,r,i;return e.canManageGroup()?s.is_pending?w.span({className:"pending-request-buttons"},t.createElement(h,{handler:e.onClickApproveJoinReq.bind(e,s)},w.button({className:"button-primary button-small action-button approve-join-req-button"},b("Approve"))),w.button({className:"remove-request-button",onClick:e.onClickRemoveJoinReq.bind(e,s)},w.img({src:"/static/images/x-vflYKfRuL.png",alt:b("Remove join request")}))):e.props.group.is_admin_managed?w.button({className:"remove-user-button",onClick:e.onClickRemoveUser.bind(e,s)},w.img({src:"/static/images/x-vflYKfRuL.png",alt:b("Remove user")})):(o=w.button({className:"settings-button"},t.createElement(l,{group:"web",name:"gear",alt:b("Member settings")})),r=[t.createElement(f,{onClick:e.onClickRemoveUser.bind(e,s)},b("Remove user"))],s.is_owner?(i=b(e.props.managedGroupsEnabled?"Remove manager permissions":"Remove owner permissions"),r.push(t.createElement(f,{onClick:T.bind(e,e.props.group,s,e.props.onGroupChanged,e.props.managedGroupsEnabled)},i))):s.can_be_owner&&(e.props.managedGroupsEnabled?(n=b("Make manager"),a=!0):(n=b("Make owner"),a=!1),r.push(t.createElement(f,{onClick:N.bind(e,e.props.group,s,e.props.onGroupChanged,a)},n))),t.createElement(g,{arrow_position:"top-right",targetButton:o,items:r,vertical_displacement:11,horizontal_displacement:0})):""}}(this)}}},componentWillMount:function(){return this.columnTypes=v(this.columnTypes,this)},renderMemberTable:function(){var e;return e=this.buildMemberList(this.props.group.pending_req_users,this.props.group.users),t.createElement(i,{ref:"members",columns:this.canManageGroup?[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(147),this.columnTypes.settings(103)]:[this.columnTypes.displayName(300),this.columnTypes.userEmail(250),this.columnTypes.joinedDate(250)],initialData:{rows:e,total:e.length},initialSortColumn:0,emptyMessage:b("This group has no members."),rowsPerPage:1e6,onRequestData:this.localSortUsers,classes:{"grey-style":!0}})},render:function(){return w.div({className:"member-list-container"},w.div({className:"group-user-info"},w.div({className:"member-count"},A("%(n)d member","%(n)d members",this.props.group.user_count).format({n:this.props.group.user_count}))),this.renderMemberTable())}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/group_members_form",["external/underscore","external/react","modules/core/exception","modules/core/i18n","modules/clean/contacts/data","modules/clean/contacts/tokenizer","modules/clean/contacts/types","modules/clean/react/input"],function(t,s,n,a,o,r,i,l){var u,m,c,d,p,h,g,f,_;return h=n.assert,p=a._,u=o.Contact,c=r.ContactsTokenizer,m=r.ContactTokenState,f=s.DOM,g=s.addons.classSet,_=s.PropTypes,d=s.createClass({displayName:"GroupMembersForm",propTypes:{group:_.object,user:_.object.isRequired,populatedContacts:_.arrayOf(_.instanceOf(u)),customClass:_.string,onChange:_.func,emailPlaceholder:_.string,messagePlaceholder:_.string,errorMessageSpaceFixed:_.bool,emailCheckerStore:_.object,includeCustomMessage:_.bool,disallowNonGroupMembers:_.bool,disallowGroupMembers:_.bool},getDefaultProps:function(){return{customClass:"",populatedContacts:[],emailPlaceholder:p("Name or email"),messagePlaceholder:p("Add a message (optional)"),includeCustomMessage:!0}},getInitialState:function(){return{errorMessage:null}},componentWillMount:function(){return this.props.populatedContacts.length>0?this._updateErrorMessage():void 0},getContacts:function(){return this.refs.tokenizer.getContacts()},getFinalData:function(e){var s,n,a,o;return this.refs.tokenizer.tokenizeAll(),s=this.getContacts(),this.props.includeCustomMessage&&(n=this.refs.message.getValue()),a=t.filter(s,function(e){return e.type===i.EMAIL}),o=t.map(a,function(e){return{email:e.email,is_owner:!1}}),this._updateErrorMessage(),e({emails:o,custom_message:n})},getGroupEmails:function(){var e;return function(){var t,s,n,a;for(n=this.props.group.users,a=[],t=0,s=n.length;s>t;t++)e=n[t],a.push(e.email);return a}.call(this)},areAllContactsValid:function(){var e;return e=this.refs.tokenizer.serializeInputData().tokens,0===e.length?!0:t.all(e,function(e){return function(t){return e._validateContact(t).state===m.ok}}(this))},isEmpty:function(){var e,t,s;return e=this.refs.tokenizer.serializeInputData(),t=e.tokens,s=e.value,0===t.length&&0===s.length},_validateContact:function(t){var s,n,a;return a={state:m.ok},t.invalid?a={state:m.invalid,msg:p("One or more names or email addresses you entered are invalid.")}:this.props.disallowGroupMembers&&(s=t.email,e.call(this.getGroupEmails(),s)>=0)?a={state:m.invalid,msg:p("Member already exists in the group.")}:t.on_team?this.props.disallowNonGroupMembers&&(n=t.email,e.call(this.getGroupEmails(),n)<0)&&(a={state:m.invalid,msg:p("This person isn’t in the group.")}):a={state:m.invalid,msg:p("This person isn’t on your team")},a},_updateErrorMessage:function(){var e,t,s,n,a,o,r;for(a=this.refs.tokenizer.serializeInputData().tokens,t=0,s=a.length;s>t;t++)if(e=a[t],o=this._validateContact(e),r=o.state,n=o.msg,r!==m.ok)return void this.setState({errorMessage:n});return this.setState({errorMessage:null})},onContentsChange:function(){var e;return this._updateErrorMessage(),"function"==typeof(e=this.props).onChange?e.onChange():void 0},render:function(){var t,n;return t={"add-group-members-form":!0,"error-message-fixed":this.props.errorMessageSpaceFixed,"has-custom-message":this.props.includeCustomMessage},this.props.customClass&&(t[this.props.customClass]=!0),h(!(this.props.disallowNonGroupMembers&&this.props.disallowGroupMembers)),n=this.props.disallowGroupMembers?function(t){return function(s){var n;return s.type===i.EMAIL&&(n=s.email,e.call(t.getGroupEmails(),n)<0)&&s.team}}(this):function(e){return e.type===i.EMAIL&&e.team},f.div({className:g(t)},f.div({className:"error-message"},this.state.errorMessage),s.createElement(c,{ref:"tokenizer",user:this.props.user,placeholder:this.props.emailPlaceholder,onContentsChange:this.onContentsChange,autofocus:!0,populatedInputData:{tokens:this.props.populatedContacts,value:""},customContactValidator:this._validateContact,customContactFilter:n}),this.props.includeCustomMessage?s.createElement(l.textarea,{ref:"message",className:"custom-message","disable-errors":!0,"aria-label":"member emails",placeholder:this.props.messagePlaceholder}):void 0)}})})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/groups_page",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/core/user_i18n","modules/clean/ajax","modules/clean/css","modules/clean/react/select","modules/clean/react/table","modules/clean/react/modal","modules/clean/react/input","modules/clean/avatar/initials_avatar_with_color","modules/clean/react/tooltip","modules/clean/viewer","modules/clean/groups/constants","modules/clean/groups/single_group_page","modules/clean/groups/search_input"],function(t,s,n,a,o,r,i,l,u,m,c,d,p,h,g,f,_){var b,v,y,w,C,M,N,T,S,A,k,R,D,x,P,I;return R=n._,N=m.Modal,A=p.Tooltip,k=p.TooltipPosition,M=g.MAX_GROUP_NAME_LEN,x=s.DOM,P=s.PropTypes,T=l.input,S=l.option,I=h.get_viewer(),D=function(e,t){var s,n,a;n={};for(a in e)s=e[a],n[a]=s.bind(t);return n},b=s.createClass({mixins:[s.addons.LinkedStateMixin],displayName:"CreateGroupModal",propTypes:{managedGroupsEnabled:P.bool,canHaveAdminUi:P.bool,insideAdminConsole:P.bool},getInitialState:function(){return{groupName:"",submitting:!1,errors:null,isAdminManaged:!0}},groupNameIsValid:function(){return this.state.groupName.length<=M},getLocalError:function(){return this.groupNameIsValid()?void 0:{message_text:R("The group name should be under %(max_len)d characters").format({max_len:M})}},getViewerMember:function(){return{name:I.display_name,email:I.work_email,is_owner:!this.props.managedGroupsEnabled||!this.props.canHaveAdminUi||!this.state.isAdminManaged}},canProceed:function(){return!this.state.submitting&&""!==this.state.groupName.trim()&&this.groupNameIsValid()},onClickCancel:function(e){return null!=e&&e.preventDefault(),this.props.insideAdminConsole||(window.location.hash="groups"),N.close()},onClickCreate:function(e){return null!=e&&e.preventDefault(),this.canProceed()&&!this.state.submitting?(this.setState({submitting:!0}),r.WebRequest({url:"/groups_ajax/make_new_group_with_users",data:{name:this.state.groupName,members:JSON.stringify([this.getViewerMember()]),is_admin_managed:this.props.managedGroupsEnabled&&this.props.canHaveAdminUi&&this.state.isAdminManaged},subject_user:I.work_user,error:function(e){return function(t,s,n){return e.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})}}(this),success:function(e){return function(t){return t=JSON.parse(t),e.props.insideAdminConsole?window.location.hash="/"+t.data.id:window.location.hash="groups/"+t.data.id,N.close()}}(this)})):void 0},onChangeGroupType:function(e){return this.setState({isAdminManaged:"true"===e.target.value})},render:function(){return s.createElement(N,{title:R("Create group"),className:"create-group-modal",acceptButtonText:R("Create"),acceptButtonDisabled:!this.canProceed(),dismissButtonText:R("Cancel"),onAccept:this.onClickCreate,onDismiss:this.onClickCancel,onDismissCompleted:this.onClickCancel,submitting:this.state.submitting},x.form({onSubmit:this.onClickCreate},x.label({className:"label-description"},R("Give your group a name")),s.createElement(c.text,{className:"group-name-input",placeholder:R("Group name"),valueLink:this.linkState("groupName"),autofocus:!0,"error-after":!0,error:this.getLocalError()}),this.props.managedGroupsEnabled&&this.props.canHaveAdminUi?x.div({className:"group-type"},x.label({className:"group-kind-label"},R("What kind of group is it?"),s.createElement(A,{position:k.RIGHT,tooltip_contents:R("In company-managed groups, admins are responsible for adding and removing members. In user-managed groups, users approve new members, and existing members can leave whenever they like."),tooltip_classname:"group-kind-tooltip-bubble"},x.img({src:"/static/images/sprites/teams/tool_tip_icon-vflUvSKa8.png"}))),x.div({className:"group-type-selection"},x.label({htmlFor:"admin-managed-radio",className:"label-text"},x.input({type:"radio",name:"group-type-radio",id:"admin-managed-radio",defaultChecked:this.state.isAdminManaged,onChange:this.onChangeGroupType,value:!0}),R("Company-managed group")),x.br({}),x.label({htmlFor:"member-managed-radio",className:"label-text"},x.input({type:"radio",name:"group-type-radio",id:"member-managed-radio",defaultChecked:!this.state.isAdminManaged,onChange:this.onChangeGroupType,value:!1}),R("User-managed group")))):void 0))}}),v=s.createClass({displayName:"GroupsList",propTypes:{title:P.string,emptyMessage:P.element,maxRows:P.number,onRequestData:P.func,showJoinReqButtons:P.bool,showPendingCountForOwners:P.bool,canViewGroupDetails:P.bool,teamName:P.string,managedGroupsEnabled:P.bool,insideAdminConsole:P.bool,onTotalGroupsChange:P.func,searchQuery:P.string},columnTypes:{displayName:function(e){return{field:"name",header:R("Name"),classes:{"group-name-column":!0},width:e,render:function(e){return x.span({},s.createElement(d,{dimension:24,initials:o.getInitials(e.name).toUpperCase(),name:e.name,shape:"SQUARE",optionalClass:"u-mar-right-s u-mar-left-xs"}),x.span({className:"group-name"},e.name))}}},members:function(t){return{field:"user_count",header:R("Members"),width:t,initialSortDir:u.DESC_DIR,render:function(t){return function(s){var n;return t.props.showPendingCountForOwners&&0!==s.join_req_pending_count&&(n=I.work_user.id,e.call(s.owner_user_ids,n)>=0)?s.user_count+" • "+s.join_req_pending_count+" "+R("pending"):s.user_count}}(this)}},owners:function(e){var t;return t=R(this.props.managedGroupsEnabled?"Managed by":"Owned by"),{field:"owners",header:t,width:e,render:function(e){return function(t){return t.is_admin_managed?e.props.teamName:t.owner_user_names.length>0?t.owner_user_names.join(", "):"-"}}(this)}},joinRequests:function(e){return{width:e,classes:{"join-request-column":!0},render:function(e){return function(t){var s;return t.owner_user_ids.length>0?(s=t.waiting_for_join_req_approval,s?x.div({className:"join-req-pending"},R("Pending")):x.button({className:"button-tertiary button-small action-button join-req-button",onClick:e.onClickJoinReq.bind(e,t),disabled:s},R("Ask to join"))):""}}(this)}}},onClickJoinReq:function(e,t){return t.stopPropagation(),e.waiting_for_join_req_approval=!0,this.forceUpdate(),r.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:e.id},subject_user:I.work_user,success:function(e){return a.success(R("Request sent."))}})},onRowClicked:function(e){return this.props.canViewGroupDetails?this.props.insideAdminConsole?window.location.hash="/"+e.id:window.location.hash="groups/"+e.id:void 0},componentWillMount:function(){return this.columnTypes=D(this.columnTypes,this)},render:function(){return x.div({className:"groups-list"},this.props.title?x.h1({className:"table-name"},this.props.title):void 0,s.createElement(u,{columns:this.props.showJoinReqButtons?[this.columnTypes.displayName(300),this.columnTypes.members(200),this.columnTypes.owners(200),this.columnTypes.joinRequests(100)]:[this.columnTypes.displayName(300),this.columnTypes.members(200),this.columnTypes.owners(300)],initialSortColumn:1,initialSortDir:u.DESC_DIR,emptyMessage:this.props.emptyMessage,rowsPerPage:this.props.maxRows,classes:{"grey-style":!0,"clickable-rows":this.props.canViewGroupDetails},rowClasses:{"group-row":!0},onRequestData:this.props.onRequestData,onRowClicked:this.onRowClicked,hideHeaderOnEmptyTable:this.props.insideAdminConsole,onTotalUpdated:this.props.onTotalGroupsChange,ref:"GroupsTable"}))},componentDidUpdate:function(e,t){return e.onRequestData!==this.props.onRequestData||e.searchQuery!==this.props.searchQuery?(this.refs.GroupsTable.onChangePage(0),this.refs.GroupsTable.forceRefresh()):void 0}}),w=s.createClass({displayName:"GroupsListPage",propTypes:{canHaveAdminUi:P.bool,groupControlledByAdmin:P.bool,managedGroupsEnabled:P.bool,teamName:P.string,isLimitedTeam:P.bool},getMyGroupsData:function(e,t){return r.WebRequest({url:"/groups_ajax/get_groups_for_user_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir},subject_user:I.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},getOtherGroupsData:function(e,t){return r.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,exclude_actors_groups:!0},subject_user:I.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},onCreateClicked:function(){return N.showInstance(s.createElement(b,{managedGroupsEnabled:this.props.managedGroupsEnabled&&!this.props.isLimitedTeam,canHaveAdminUi:this.props.canHaveAdminUi,insideAdminConsole:!1}))},render:function(){return x.div({className:"groups-page"},x.div({className:"page-heading-buttons"},this.props.canHaveAdminUi||!this.props.groupControlledByAdmin?x.button({className:"button-primary action-button create-group-button",onClick:this.onCreateClicked},R("Create Group")):void 0),x.div({className:"my-groups-list"},s.createElement(v,{title:R("My groups"),emptyMessage:x.span({},R("You’re not a member of any groups yet. To join one, select the group name and then click the "),x.b({},R("Ask to join button")),".",x.br(),R("You can also start a new group by clicking "),x.b({},R("Create group")),R(".")),maxRows:5,onRequestData:this.getMyGroupsData,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,managedGroupsEnabled:this.props.managedGroupsEnabled,insideAdminConsole:!1})),x.div({className:"more-groups-list"},s.createElement(v,{title:R("More groups"),emptyMessage:x.span({},R("You’re a member of every group. You can start a new group by clicking "),x.b({},R("Create group")),R(".")),maxRows:10,onRequestData:this.getOtherGroupsData,showJoinReqButtons:!0,showPendingCountForOwners:!1,canViewGroupDetails:this.props.canHaveAdminUi,teamName:this.props.teamName,managedGroupsEnabled:this.props.managedGroupsEnabled,insideAdminConsole:!1})))}}),y=s.createClass({displayName:"GroupsListForAdminsPage",propTypes:{teamName:P.string},getInitialState:function(){return{filterValue:"all_groups",hasGroups:!1,searchQuery:null,tableVisible:!0}},getGroupsData:function(e,t){return r.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!1,search_query:this.state.searchQuery},subject_user:I.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},getCompanyManagedGroupsData:function(e,t){return r.WebRequest({url:"/groups_ajax/get_groups_for_team_paginated",data:{offset:e.offset,limit:e.limit,sort_column:e.sortColumn,sort_direction:e.sortDir,only_company_managed:!0,search_query:this.state.searchQuery},subject_user:I.work_user,success:function(e){return e=JSON.parse(e),t(null,{rows:e.groups,total:e.total_groups})}})},onCreateClicked:function(){return N.showInstance(s.createElement(b,{managedGroupsEnabled:!0,canHaveAdminUi:!0,insideAdminConsole:!0}))},render:function(){return x.div({className:"groups-page"},x.div({className:"page-heading-buttons"},x.button({className:"button-primary action-button create-group-button",onClick:this.onCreateClicked},R("Create Group")),this.renderFindPanel()),this.renderGroupsList())},renderFindPanel:function(){return this.state.hasGroups>0||"company_managed_groups"===this.state.filterValue||null!==this.state.searchQuery?x.span({className:"group-find-panel"},x.span({className:"group-search"},s.createElement(_,{placeholder:R("Search groups"),onTriggerSearch:this.onTriggerSearch,onEnterSearch:this.hideTable,onExitSearch:this.onExitSearch,onClearSearchQuery:this.hideTable})),x.span({className:"groups-filter"},x.span({className:"label"},R("Show")),s.createElement(T,{name:"filter-select-input",onChange:this.onUserFilterChange,"disable-errors":!0,value:this.state.filterValue},s.createElement(S,{value:"all_groups",key:"all_groups",id:"option-all-groups"},x.span({className:"text"},R("All groups"))),s.createElement(S,{value:"company_managed_groups",key:"company_managed_groups",id:"option-company-managed-groups"},x.span({className:"text"},R("Company-managed groups")))))):void 0},renderGroupsList:function(){var e,t;if(this.state.tableVisible)return"all_groups"===this.state.filterValue?(t=this.getGroupsData,e=x.span({className:"admin-console-empty-message"},x.div({className:"empty-groups-illustration"},x.img({className:"empty-groups-image",src:"/static/images/groups/groups_empty_illustration-vflibL0ss.svg"})),x.div({className:"empty-groups-view-header"},R("You don’t have any groups yet.")),x.div({className:"empty-groups-desc"},R("Groups make it easier to share with common lists of people in your team.")))):(t=this.getCompanyManagedGroupsData,e=x.span({},R("You don’t have any company-managed group."))),null!==this.state.searchQuery&&(e=x.span({},R("Didn’t find any matching group."))),x.div({className:"more-groups-list"},s.createElement(v,{title:null,emptyMessage:e,maxRows:15,onRequestData:t,showJoinReqButtons:!1,showPendingCountForOwners:!0,canViewGroupDetails:!0,teamName:this.props.teamName,managedGroupsEnabled:!0,insideAdminConsole:!0,onTotalGroupsChange:this.onTotalGroupsChange,searchQuery:this.state.searchQuery}))},onUserFilterChange:function(e,t){return this.setState({filterValue:t})},onTotalGroupsChange:function(e){return this.setState({hasGroups:e>0})},onTriggerSearch:function(e){return this.setState({searchQuery:e,tableVisible:!0})},onExitSearch:function(){return this.setState({searchQuery:null,tableVisible:!0})},hideTable:function(){return this.setState({tableVisible:!1})}}),C=s.createClass({displayName:"GroupsPageContainer",propTypes:{canHaveAdminUi:P.bool,groupControlledByAdmin:P.bool,managedGroupsEnabled:P.bool,teamName:P.string,isLimitedTeam:P.bool,insideAdminConsole:P.bool,isWebActionsAsync:P.bool},getInitialState:function(){return{viewingGroupId:this.groupIdFromHash()}},componentWillMount:function(){return t(window).on("hashchange",function(e){return function(){return e.setState({viewingGroupId:e.groupIdFromHash()})}}(this))},groupIdFromHash:function(){var e,s,n,a;return s=null!=(a=window.location.hash)?a.split("#").pop():void 0,t("#sharing-tabs").length>0||this.props.insideAdminConsole?(n=null!=s?s.split("/"):void 0,e=null!=n?n[1]:void 0):e=s,null!=e&&""!==e?e:void 0},render:function(){return i.require_css("/static/css/groups/react_groups-vflz-Gwo5.css"),i.require_css("/static/css/react/table-vfl33k2n5.css"),null!=this.state.viewingGroupId?"newgroup"===this.state.viewingGroupId?s.createElement(b,{managedGroupsEnabled:this.props.managedGroupsEnabled&&!this.props.isLimitedTeam,canHaveAdminUi:this.props.canHaveAdminUi,insideAdminConsole:this.props.insideAdminConsole}):s.createElement(f,{groupId:this.state.viewingGroupId,canHaveAdminUi:this.props.canHaveAdminUi,managedGroupsEnabled:this.props.managedGroupsEnabled,teamName:this.props.teamName,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,isWebActionsAsync:this.props.isWebActionsAsync}):this.props.insideAdminConsole?s.createElement(y,{teamName:this.props.teamName}):s.createElement(w,{canHaveAdminUi:this.props.canHaveAdminUi,groupControlledByAdmin:this.props.groupControlledByAdmin,managedGroupsEnabled:this.props.managedGroupsEnabled,teamName:this.props.teamName,isLimitedTeam:this.props.isLimitedTeam})}})})}.call(this),function(){define("modules/clean/groups/simple_modals",["external/react","external/purify","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/viewer","modules/clean/react/modal"],function(e,t,s,n,a,o,r){var i,l,u,m,c,d,p,h,g;return l=s._,i=r.SimpleModal,g=o.get_viewer(),u=function(e,s){var o;return o=s?l("Deleting “%(group_name)s” will cause all of its members to lose access to folders that have been shared with the group. You will not be able to undo this. <br/><br/>It might take a little while for deleted groups to be removed from all their shared folders.<br/><br/> Are you sure you want to delete the group?").format({group_name:e.name}):l("Deleting “%(group_name)s” will cause all of its members to lose access to folders that have been shared with the group. You will not be able to undo this. <br/><br/>Are you sure you want to delete the group?").format({group_name:e.name}),i.show({title_text:l("Delete “%(group_name)s”?").format({group_name:e.name}),body_html:t.sanitize(o),confirm_text:l("Delete"),cancel_text:l("Cancel"),confirm_callback:function(){return a.WebRequest({url:"/groups_ajax/remove_group",
data:{group_id:e.id},subject_user:g.work_user,success:function(e){return e=JSON.parse(e),null===e.data?n.success(l("Deleted group.")):n.success(l("Deleting group...")),window.location.hash="groups"}})}})},m=function(e,s){var o;return o=s?l("Leaving “%(group_name)s” will cause you to lose access to folders that have been shared with the group.<br/><br/> It might take a litle while to remove you from all of the group’s shared folders.<br/><br/> Are you sure you want to leave the group?").format({group_name:e.name}):l("Leaving “%(group_name)s” will cause you to lose access to folders that have been shared with the group.<br/><br/> Are you sure you want to leave the group?").format({group_name:e.name}),i.show({title_text:l("Leave “%(group_name)s”?").format({group_name:e.name}),body_html:t.sanitize(o),confirm_text:l("Leave"),cancel_text:l("Cancel"),confirm_callback:function(){return a.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:g.work_user.id},subject_user:g.work_user,success:function(e){return e=JSON.parse(e),null===e.data?n.success(l("Left group.")):n.success(l("Leaving group...")),window.location.hash="groups"}})}})},p=function(e,s,o,r){var u;return u=r?l("Removing %(name)s will cause them to lose access to folders that have been shared with the group.<br/><br/> It might take a little while to remove members from all of this group’s shared folders.<br/><br/> Are you sure you want to do this?").format({name:s.name}):l("Removing %(name)s will cause them to lose access to folders that have been shared with the group.<br/><br/> Are you sure you want to do this?").format({name:s.name}),i.show({title_text:l("Remove %(name)s?").format({name:s.name}),body_html:t.sanitize(u),confirm_text:l("Remove"),cancel_text:l("Cancel"),confirm_callback:function(){return a.WebRequest({url:"/groups_ajax/remove_user_from_group",data:{group_id:e.id,user_id:s.user_id},subject_user:g.work_user,success:function(e){return e=JSON.parse(e),null===e.data?n.success(l("Member removed.")):n.success(l("Removing member...")),"function"==typeof o?o(s):void 0}})}})},d=function(e,s,n,o){var r,u,m;return o?(m=l("Remove manager permissions from %(name)s?").format({name:s.name}),u=l("Remove manager permissions"),r=l("%(name)s will no longer be able to add and remove managers, change group information, or delete the group.").format({name:s.name})):(m=l("Are you sure you want to remove owner permissions from %(name)s?").format({name:s.name}),u=l("Remove owner permissions"),r=l("%(name)s will no longer be able to add and remove owners or change group information.<br/><strong>%(name)s will also no longer be able to delete the group.</strong>").format({name:s.name})),i.show({title_text:m,body_html:t.sanitize(r),confirm_text:u,confirm_callback:function(t){return function(){return a.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:s.user_id,is_owner:!1},subject_user:g.work_user,error:function(e,s,n){return t.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})},success:function(t){return s.is_owner=!1,e.owners=e.owners.filter(function(e){return e.email!==s.email}),s.user_id===g.work_user.id&&(e.is_owner=!1),n(!1,e)}})}}(this)})},c=function(e,s,n,o){var r,u,m;return o?(m=l("Make %(name)s a manager?").format({name:s.name}),u=l("Make manager"),r=l("%(name)s will be able to add and remove managers, and change group information. <br/>%(name)s will also be able to delete the group.").format({name:s.name})):(m=l("Are you sure you want to make %(name)s an owner?").format({name:s.name}),u=l("Make owner"),r=l("%(name)s will be able to add and remove owners, and change group information.<br/><strong>%(name)s will also be able to delete the group.</strong>").format({name:s.name})),i.show({title_text:m,body_html:t.sanitize(r),confirm_text:u,confirm_callback:function(t){return function(){return a.WebRequest({url:"/groups_ajax/change_group_member_type",data:{group_id:e.id,user_id:s.user_id,is_owner:!0},subject_user:g.work_user,error:function(e,s,n){return t.setState({submitting:!1,errors:function(){try{return JSON.parse(n)}catch(e){}}()})},success:function(t){var a;return s.is_owner=!0,a={name:s.name,email:s.email},e.owners.push(a),n(!1,e)}})}}(this)})},h=function(e,s){return i.show({title_text:l("Make company-managed?"),body_html:t.sanitize(l("This will become a company-managed group, and admins will be responsible for adding and removing members.")),confirm_text:l("Make company-managed"),cancel_text:l("Cancel"),confirm_callback:function(){return a.WebRequest({url:"/groups_ajax/change_to_admin_managed_type",data:{group_id:e.id},subject_user:g.work_user,success:function(t){return n.success(l("%(group_name)s is now company-managed").format({group_name:e.name})),s()}})}})},{showDeleteGroupModal:u,showLeaveGroupModal:m,showRemoveUserModal:p,showRemoveOwnerPermissionsModal:d,showMakeOwnerModal:c,showSwitchToAdminManagedGroupModal:h}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/groups/single_group_page",["external/react","modules/core/i18n","modules/core/notify","modules/core/user_i18n","modules/clean/ajax","modules/clean/css","modules/clean/react/modal","modules/clean/react/button","modules/clean/avatar/initials_avatar_with_color","modules/clean/react/image","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/dbox_app_promo","modules/clean/viewer","modules/clean/static_urls","modules/clean/groups/change_group_name_modal","modules/clean/groups/add_group_members_modal","modules/clean/groups/group_member_list","modules/clean/groups/simple_modals","modules/clean/groups/switch_to_member_managed_group_modal"],function(t,s,n,a,o,r,i,l,u,m,c,d,p,h,g,f,_,b,v,y){var w,C,M,N,T,S,A,k,R,D,x,P,I,E,L;return A=s._,N=i.Modal,C=d.BubbleMenu,M=d.BubbleMenuItem,w=p.Actionable,E=g.static_url,P=v.showLeaveGroupModal,x=v.showDeleteGroupModal,I=v.showSwitchToAdminManagedGroupModal,R=t.DOM,D=t.PropTypes,k=t.createElement,L=h.get_viewer(),T=t.createClass({displayName:"SingleGroupHeader",propTypes:{group:D.object,canHaveAdminUi:D.bool,managedGroupsEnabled:D.bool,teamName:D.string,onGroupChanged:D.func,groupControlledByAdmin:D.bool,isLimitedTeam:D.bool,insideAdminConsole:D.bool,isWebActionsAsync:D.bool},getInitialState:function(){return{showDropdown:!1,requestPending:this.viewerHasPendingJoinReq()}},viewerIsOwner:function(){return this.props.group.is_owner},viewerIsMember:function(){var e,t,s,n;for(s=this.props.group.users,e=0,t=s.length;t>e;e++)if(n=s[e],n.user_id===L.work_user.id)return!0;return!1},viewerHasPendingJoinReq:function(){var e,t,s,n;for(s=this.props.group.pending_req_users,e=0,t=s.length;t>e;e++)if(n=s[e],n.user_id===L.work_user.id)return!0;return!1},onClickJoinReq:function(){return o.WebRequest({url:"/groups_ajax/make_group_join_request",data:{group_id:this.props.group.id},subject_user:L.work_user,success:function(e){return function(t){return n.success(A("Request sent.")),e.setState({requestPending:!0})}}(this)})},showChangeNameModal:function(){return N.showInstance(t.createElement(f,{origGroupName:this.props.group.name,groupId:this.props.group.id,onNameChanged:function(e){return function(t){return e.props.group.name=t,e.forceUpdate()}}(this)}))},showAddMembersModal:function(){return N.showInstance(t.createElement(_,{group:this.props.group,onGroupChanged:this.props.onGroupChanged,isWebActionsAsync:this.props.isWebActionsAsync}))},renderBackToGroups:function(){var e;return e=this.props.insideAdminConsole?"#/":"#groups",R.a({className:"back-to-groups-link",href:e},R.span({className:"back-arrow"},t.createElement(m,{src:E("/static/images/groups/back-vflek6neR.png"),srcHiRes:E("/static/images/groups/back@2x-vflsptBUj.png")})),A("Back to Groups"))},renderGroupInfo:function(){var e,s,n,o,r,i,l;if(this.props.group.is_admin_managed)i=this.props.teamName;else if(this.props.group.owners.length>0){for(r=[],l=this.props.group.owners,e=0,s=l.length;s>e;e++)n=l[e],r.push(n.name);i=r.join(", ")}else i="-";return o=A(this.props.managedGroupsEnabled?"Managed by ":"Owned by "),R.div({className:"current-location"},R.span({className:"group-info-container"},t.createElement(u,{dimension:48,name:this.props.group.name,initials:a.getInitials(this.props.group.name).toUpperCase(),shape:"SQUARE",optionalClass:"u-mar-right-s"})),R.span({className:"group-info"},R.span({className:"group-name-container"},R.span({className:"group-name"},this.props.group.name),this.props.canHaveAdminUi||this.viewerIsOwner()?R.button({className:"group-change-link",onClick:this.showChangeNameModal},A("Change")):void 0),R.span({className:"group-managers"},o+i)))},renderGroupActionsButton:function(){var e,s;return e=t.createElement(l.button,{className:"group-actions-button",importance:"secondary"},t.createElement(c,{group:"web",name:"more",alt:A("More actions")})),s=this.viewerIsMember()?[k(M,{onClick:P.bind(this,this.props.group,this.props.isWebActionsAsync)},A("Leave group")),k(M,{onClick:x.bind(this,this.props.group,this.props.isWebActionsAsync)},A("Delete group"))]:[k(M,{onClick:x.bind(this,this.props.group,this.props.isWebActionsAsync)},A("Delete group"))],this.props.managedGroupsEnabled&&this.props.canHaveAdminUi&&!this.props.isLimitedTeam&&(this.props.group.is_admin_managed?s.splice(0,0,k(M,{onClick:this.showSwitchToMemberManagedGroupModal},A("Make user-managed"))):s.splice(0,0,k(M,{onClick:I.bind(this,this.props.group,this.onAdminManaged)},A("Make company-managed")))),t.createElement(C,{arrow_position:"top-right",targetButton:e,items:s,vertical_displacement:5})},onAdminManaged:function(){return this.props.onGroupChanged(!0,null)},onMemberManaged:function(t){var s,n,a,o,r,i,l,u;for(r=0,this.props.group.is_admin_managed=!1,this.props.group.owners=[],i=this.props.group.users,n=0,a=i.length;a>n;n++)u=i[n],l=u.email,e.call(t,l)>=0&&(u.is_owner=!0,this.props.group.owners.push(u),r+=1);return o=t.length,s=o>r,this.props.onGroupChanged(s,this.props.group)},showSwitchToMemberManagedGroupModal:function(){return N.showInstance(t.createElement(y,{group:this.props.group,onMemberManaged:this.onMemberManaged}))},renderOwnerButtons:function(){return R.span({className:"group-admin-controls"},t.createElement(l.button,{className:"add-members-button",importance:"primary",onClick:this.showAddMembersModal},A("Add members")),this.renderGroupActionsButton())},renderNonOwnerMemberButtons:function(){return t.createElement(l.button,{className:"leave-group-button",importance:"tertiary",onClick:P.bind(this,this.props.group,this.props.isWebActionsAsync)},A("Leave group"))},renderNonMemberButtons:function(){return this.props.group.owners.length>0?this.state.requestPending?t.createElement(l.button,{className:"ask-to-join-button",importance:"tertiary",disabled:!0},A("Pending")):t.createElement(w,{handler:this.onClickJoinReq},t.createElement(l.button,{className:"ask-to-join-button",importance:"tertiary"},A("Ask to join"))):void 0},render:function(){return R.div({className:"single-group-header"},R.div({className:"group-header"},this.renderBackToGroups(),this.renderGroupInfo()),R.div({className:"group-control-buttons"},this.props.canHaveAdminUi?this.renderOwnerButtons():this.props.group.is_admin_managed?void 0:this.viewerIsOwner()?this.renderOwnerButtons():this.viewerIsMember()?this.props.groupControlledByAdmin?void 0:this.renderNonOwnerMemberButtons():this.renderNonMemberButtons()))}}),S=t.createClass({displayName:"SingleGroupPage",propTypes:{groupId:D.string,canHaveAdminUi:D.bool,managedGroupsEnabled:D.bool,teamName:D.string,groupControlledByAdmin:D.bool,isLimitedTeam:D.bool,insideAdminConsole:D.bool,isWebActionsAsync:D.bool},getInitialState:function(){return{group:void 0}},componentWillMount:function(){return this.fetchGroup()},fetchGroup:function(){return this.setState({loading:!0}),o.WebRequest({url:"/groups_ajax/get_group_info",data:{group_id:this.props.groupId},subject_user:L.work_user,success:function(e){return function(t){return e.isMounted()?(t=JSON.parse(t),e.setState({group:t.data,loading:!1})):void 0}}(this)})},renderSpinner:function(){return R.div({className:"groups-spinner"},t.createElement(m,{src:E("/static/images/icons/ajax-loading-small-blue-vflm7vRcz.gif"),srcHiRes:E("/static/images/icons/ajax-loading-small-blue@2x-vfljkfH6D.gif"),alt:A("Loading")}))},onGroupChanged:function(e,t){return e?this.fetchGroup():this.setState({group:t})},render:function(){return this.state.loading?this.renderSpinner():(r.require_css("/static/css/react/contacts_tokenizer-vflR5K70C.css"),R.div({className:"single-group-view"},t.createElement(T,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,managedGroupsEnabled:this.props.managedGroupsEnabled,teamName:this.props.teamName,onGroupChanged:this.onGroupChanged,groupControlledByAdmin:this.props.groupControlledByAdmin,isLimitedTeam:this.props.isLimitedTeam,insideAdminConsole:this.props.insideAdminConsole,isWebActionsAsync:this.props.isWebActionsAsync}),t.createElement(b,{group:this.state.group,canHaveAdminUi:this.props.canHaveAdminUi,managedGroupsEnabled:this.props.managedGroupsEnabled,onGroupChanged:this.onGroupChanged,isWebActionsAsync:this.props.isWebActionsAsync})))}})})}.call(this),function(){define("modules/clean/groups/switch_to_member_managed_group_modal",["jquery","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/groups/group_members_form","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,a,o,r,i){var l,u,m,c,d,p;return m=s._,l=r.Modal,c=t.DOM,d=t.PropTypes,p=i.get_viewer(),u=t.createClass({displayName:"SwitchToMemberManagedGroupModal",propTypes:{group:d.object,onMemberManaged:d.func},getInitialState:function(){return{canProceed:!0,submitting:!1}},componentDidMount:function(){return e(".contacts-tokenizer-input").select()},_canProceed:function(){var e;return null!=(e=this.refs.members)?e.areAllContactsValid():void 0},onSubmit:function(e){return e.preventDefault(),this.refs.members.getFinalData(function(e){return function(t){var s,o,r,i;return o=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s?(e.setState({submitting:!0}),r=e.props.group.name,i=e.props.onMemberManaged,a.WebRequest({url:"/groups_ajax/change_to_member_managed_type",data:{new_owners:JSON.stringify(o),group_id:e.props.group.id},subject_user:p.work_user,complete:function(){return e.isMounted()?e.setState({submitting:!1}):void 0},success:function(e){var t,s;return n.success(m("%(group_name)s is now user-managed").format({group_name:r})),l.close(),s=function(){var e,s,n;for(n=[],e=0,s=o.length;s>e;e++)t=o[e],n.push(t.email);return n}(),i(s)}})):void 0}}(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return t.createElement(l,{title:m("Make user-managed?"),acceptButtonText:m("Make user-managed"),dismissButtonText:m("Cancel"),acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,onAccept:this.onSubmit,ref:"modal"},c.label({className:"label-description"},m("This will become a user-managed group, and the person you choose below will be responsible for approving new members. Group members can leave whenever they like.")),c.br({}),c.br({}),c.label({className:"label-description-secondary"},m("Who should manage this group?")),t.createElement(o,{ref:"members",group:this.props.group,user:p.work_user,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:m("Name or email address"),disallowNonGroupMembers:!1,disallowGroupMembers:!1}))}})})}.call(this),function(){define("modules/clean/react/paginator",["external/classnames","external/react","external/underscore","modules/core/i18n"],function(e,t,s,n){var a,o,r,i;return o=n._,r=t.DOM,a=t.createClass({displayName:"PaginatorPageButton",propTypes:{enabled:t.PropTypes.bool,active:t.PropTypes.bool,onClick:t.PropTypes.func},render:function(){var t;return r.li({onClick:this.props.onClick},this.props.enabled?(t={"pagination-link":!0,active:this.props.active},r.a({href:"#",className:e(t)},this.props.children)):r.span({className:"pagination-link disabled"},this.props.children))},getDefaultProps:function(){return{enabled:!0,active:!0,onClick:function(){}}}}),i=t.createClass({displayName:"Paginator",propTypes:{max_visible_pages:t.PropTypes.number,onChangePage:t.PropTypes.func,num_pages:t.PropTypes.number},render:function(){var e,s,n;return s=r.span({className:"arrow arrow-left"},o("Previous")),n=r.span({className:"arrow arrow-right"},o("Next")),r.div({className:"nav nav-inline"},r.ol({className:"pagination"},this.need_arrows()?t.createElement(a,{enabled:this.left_button_enabled(),onClick:this.left_clicked},s):void 0,function(){var s,n,o,r;for(o=this.current_visible_pages(),r=[],s=0,n=o.length;n>s;s++)e=o[s],r.push(t.createElement(a,{active:e===this.state.active_page,onClick:this.page_clicked.bind(this,e),key:e},""+(e+1)));return r}.call(this),this.need_arrows()?t.createElement(a,{enabled:this.right_button_enabled(),onClick:this.right_clicked},n):void 0))},getInitialState:function(){return{first_page:0,active_page:0}},getDefaultProps:function(){return{max_visible_pages:9,onChangePage:function(){},num_pages:1}},need_arrows:function(){return this.props.num_pages>this.props.max_visible_pages},left_button_enabled:function(){return this.need_arrows()&&this.state.active_page>0},right_button_enabled:function(){return this.need_arrows()&&this.state.active_page<this.props.num_pages-1},current_visible_pages:function(){var e,t,n;return n=this.state.first_page,e=s.min([this.props.num_pages,this.state.first_page+this.props.max_visible_pages]),function(){t=[];for(var s=n;e>=n?e>s:s>e;e>=n?s++:s--)t.push(s);return t}.apply(this)},ensure_in_range:function(e,t,s){return Math.max(t,Math.min(s,e))},setActivePage:function(e){var t,s;e=this.ensure_in_range(e,0,this.props.num_pages-1),t=e-Math.floor(this.props.max_visible_pages/2),t=this.ensure_in_range(t,0,this.props.num_pages-this.props.max_visible_pages),s=t+this.props.max_visible_pages,e!==this.state.active_page&&this.props.onChangePage(e),this.setState({first_page:t,last_page:s,active_page:e})},left_clicked:function(e){return e.preventDefault(),this.setActivePage(this.state.active_page-1)},right_clicked:function(e){return e.preventDefault(),this.setActivePage(this.state.active_page+1)},page_clicked:function(e,t){return t.preventDefault(),this.setActivePage(e)}})})}.call(this),function(){var e=[].slice;define("modules/clean/react/table",["external/react","jquery","external/lru","modules/core/i18n","modules/clean/react/paginator"],function(t,s,n,a,o){var r,i,l,u,m,c,d,p,h;return m=a._,p=t.DOM,c=t.addons.classSet,h=t.PropTypes,d=function(){var t;return t=1<=arguments.length?e.call(arguments,0):[],c(s.extend.apply(s,[{}].concat(e.call(t))))},r=1,i=-1,u="—",l=t.createClass({displayName:"Table",propTypes:{columns:h.arrayOf(h.shape({field:h.string,header:h.node,width:h.oneOfType([h.number,h.string]),sortable:h.bool,initialSortDir:h.number,classes:h.object,render:h.func})),onRequestData:h.func,onTotalUpdated:h.func,initialData:h.shape({total:h.number,rows:h.array}),emptyMessage:h.node,classes:h.object,headerClasses:h.object,bodyClasses:h.object,rowClasses:h.oneOfType([h.object,h.func]),cellClasses:h.object,initialSortColumn:h.number,initialSortDir:h.number,rowsPerPage:h.number,loadingIndicator:h.string,onRowClicked:h.func,hideHeaderOnEmptyTable:h.bool},statics:{ASC_DIR:r,DESC_DIR:i},getDefaultProps:function(){return{initialSortColumn:0,initialSortDir:r,rowsPerPage:10,hideHeaderOnEmptyTable:!1}},getInitialState:function(){var e,t,s,n;return{total:null!=(e=null!=(t=this.props.initialData)?t.total:void 0)?e:0,rows:null!=(s=null!=(n=this.props.initialData)?n.rows:void 0)?s:[],currentPage:0,sortColumn:this.props.initialSortColumn,sortDir:this.props.initialSortDir}},componentWillMount:function(){var e;return this.cache=new n(1e3),(null!=(e=this.props.initialData)?e.rows:void 0)?void 0:this.refreshData()},forceRefresh:function(){return this.cache.removeAll(),this.refreshData()},refreshData:function(){var e,t,s,n,a;return this.setState({loading:!0}),n={offset:this.state.currentPage*this.props.rowsPerPage,limit:this.props.rowsPerPage,sortColumn:null!=(s=this.props.columns[this.state.sortColumn])?s.field:void 0,sortDir:this.state.sortDir},e=JSON.stringify(n),(t=this.cache.get(e))?(this.setState(t),void this.setState({loading:!1})):(null==this.requestId&&(this.requestId=0),a=++this.requestId,this.props.onRequestData(n,function(t){return function(s,n){var o,r;if(null==s&&t.requestId===a)return r={rows:n.rows,total:n.total},t.cache.put(e,r),"function"==typeof(o=t.props).onTotalUpdated&&o.onTotalUpdated(r.total),t.setState(r),t.setState({loading:!1})}}(this)))},onColumnHeaderClick:function(e){var t,s;if(this.props.columns[e].sortable!==!1)return t=e===this.state.sortColumn?{sortDir:-this.state.sortDir}:{sortColumn:e,sortDir:null!=(s=this.props.columns[e].initialSortDir)?s:r},this.setState(t,function(e){return function(){return e.refreshData()}}(this))},onChangePage:function(e){return this.setState({currentPage:e},this.refreshData)},render:function(){var e,s,n,a,l,c;return n=0===this.state.total&&!this.state.loading,p.div({className:d(this.props.classes,{"table-container":!0})},n&&this.props.hideHeaderOnEmptyTable?void 0:p.div({className:d(this.props.headerClasses,{"table-header":!0})},function(){var t,n,a,o;for(a=this.props.columns,o=[],e=t=0,n=a.length;n>t;e=++t)s=a[e],o.push(p.div({className:d(s.classes,this.props.cellClasses,{"table-column-header":!0,nonsortable:s.sortable===!1,sorted:s.sortable!==!1&&this.state.sortColumn===e}),style:{width:s.width},onClick:this.onColumnHeaderClick.bind(this,e),key:e},s.header,function(){if(s.sortable!==!1&&this.state.sortColumn===e)switch(this.state.sortDir){case r:return p.span({className:"sort-arrow sort-arrow-up"});case i:return p.span({className:"sort-arrow sort-arrow-down"})}}.call(this)));return o}.call(this)),n?p.div({className:"empty-message"},this.props.emptyMessage):this.state.rows.length>0?p.ol({className:d(this.props.bodyClasses,{"table-body":!0,loading:this.state.loading})},function(){var t,n,o,r,i;for(o=this.state.rows,i=[],c=t=0,n=o.length;n>t;c=++t)a=o[c],l="function"==typeof this.props.rowClasses?this.props.rowClasses(a):this.props.rowClasses,i.push(p.li({className:d(l,{"table-row":!0}),key:c,onClick:null!=(r=this.props.onRowClicked)?r.bind(this,a):void 0},function(){var t,n,o,r,i,l;for(o=this.props.columns,l=[],e=t=0,n=o.length;n>t;e=++t)s=o[e],l.push(p.span({className:d(s.classes,this.props.cellClasses,{"table-cell":!0}),style:{width:s.width},key:e},null!=(r=null!=(i="function"==typeof s.render?s.render(a):void 0)?i:a[s.field])?r:p.span({className:"null-field"},u)));return l}.call(this)));return i}.call(this)):p.div({className:"spacer"}),this.state.loading?p.div({className:"loading-message"},this.props.loadingIndicator?p.img({src:this.props.loadingIndicator}):m("Loading...")):void 0,this.state.total>this.props.rowsPerPage?t.createElement(o,{num_pages:Math.ceil(this.state.total/this.props.rowsPerPage),onChangePage:this.onChangePage}):void 0)}})})}.call(this),function(){define("modules/clean/react/teams/modals/limited_team_upsell_modal_banner",["external/react","modules/core/browser","modules/core/uri","modules/clean/react/button","modules/clean/analytics"],function(e,t,s,n,a){var o,r,i,l,u,m;return i=n.button,r=a.TeamsWebActionsLogger,u=e.DOM,l=e.createElement,m=e.PropTypes,o=e.createClass({mixins:[e.addons.PureRenderMixin],propTypes:{upgradeButtonText:m.string.isRequired,upsellText:m.string.isRequired,logEventName:m.string,redirectQuery:m.shape({tk:m.string,_camp:m.string})},displayName:"LimitedTeamUpsellModalBanner",_handleCTAClick:function(){return this.props.logEventName&&r.log(this.props.logEventName,{},null,null,!1,r.LOG_CATEGORY.UPGRADE),t.redirect(s({path:"/team/upgrade",query:this.props.redirectQuery}))},render:function(){return u.div({className:"modal-upsell-bar"},u.div({className:"modal-upsell-bar__message"},this.props.upsellText),u.div({className:"modal-upsell-bar__action"},l(i,{className:"modal-upsell-bar__cta-button",onClick:this._handleCTAClick},this.props.upgradeButtonText)))}})})}.call(this),function(){define("modules/clean/teams/limited_team_invite_and_settings_modal",["external/react","external/underscore","modules/core/browser","modules/core/html","modules/core/i18n","modules/core/notify","modules/clean/analytics","modules/clean/ajax","modules/clean/contacts/data","modules/clean/teams/constants","modules/clean/teams/limited_team_invite_form","modules/clean/teams/request_membership_policy_select","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,a,o,r,i,l,u,m,c,d,p){var h,g,f,_,b,v,y,w,C;return b=a._,C=a.ungettext,_=r.TeamsWebActionsLogger,h=l.Contact,f=u.REQUEST_MEMBERSHIP_POLICY_LABEL_VARIANTS,g=d.Modal,v=e.createElement,y=e.DOM,w=e.PropTypes,e.createClass({displayName:"LimitedTeamInviteAndSettingsModal",mixins:[e.addons.LinkedStateMixin],propTypes:{viewer:w.instanceOf(p),onInvited:w.func,onDismissCompleted:w.func,canSetTeamRequestMembershipPolicy:w.bool,initialTeamRequestMembershipPolicy:w.number.isRequired,suggested_contacts:w.arrayOf(w.instanceOf(h)),memberInviteLimit:w.number,maxTeamSize:w.number},getDefaultProps:function(){return{viewer:p.get_viewer()}},getInitialState:function(){return{requestMembershipPolicy:this.props.initialTeamRequestMembershipPolicy,submitting:!1,canProceed:!1}},componentDidMount:function(){return this._checkCanProceed()},_checkCanProceed:function(){var e;return this.setState({canProceed:null!=(e=this.refs.inviteForm)?e.areAllContactsValid():void 0})},_tryInviteMembersIfAny:function(e){return this.refs.inviteForm.getFinalData(function(s){return function(a){var r,l;return l=a.emails,r=a.custom_message,0===l.length?e(0):(s.setState({submitting:!0}),i.WebRequest({url:"/account/team/add_users",subject_user:s.props.viewer.work_user,data:{emails:l,custom_message:r,team_id:s.props.viewer.team_id},success:function(n){var a;return n=JSON.parse(n),a=t.values(n.users),a.length>0?e(a.length):(o.error(),s.setState({submitting:!1}))},error:function(e){return"rate-limit"===e.getResponseHeader("x-dropbox-app-error")?o.error(new n(b('%(team_name)s has reached the maximum number of team members allowed on Dropbox Basic. Please <a href="/business/contact">contact sales</a> to add more members to your team.').format({team_name:s.props.viewer.team_name}))):o.error(),s.setState({submitting:!1})}}))}}(this))},_setPolicyIfChanged:function(e){return this.props.canSetTeamRequestMembershipPolicy&&this.props.initialTeamRequestMembershipPolicy!==this.state.requestMembershipPolicy?(this.setState({submitting:!0}),i.WebRequest({url:"/team/manage/set_request_membership_policy",data:{new_team_policy:this.state.requestMembershipPolicy},error:function(e){return function(){return e.setState({submitting:!1}),o.error()}}(this),success:function(t){return function(){return e(!0)}}(this)})):e(!1)},_onCTAButtonClick:function(){return!this.state.submitting&&this.state.canProceed?this._tryInviteMembersIfAny(function(e){return function(t){var s;return t>0&&"function"==typeof(s=e.props).onInvited&&s.onInvited(),e._setPolicyIfChanged(function(s){var n;return e._notifyTeamCreated(),_.log("confirm_clicked_invite_members",{num_invited_users:t,new_team_discovery:s?e.state.requestMembershipPolicy:null,dismiss:!1}),e.refs.modal.close(),"function"==typeof(n=e.props).onDismissCompleted?n.onDismissCompleted(s):void 0})}}(this)):void 0},_notifyTeamCreated:function(){return o.success(b("%(team_name)s team successfully created!").format({team_name:this.props.viewer.team_name}))},_logDismiss:function(){return _.log("confirm_clicked_invite_members",{num_invited_users:0,new_team_discovery:null,dismiss:!0})},_handleDismiss:function(){return this._logDismiss(),this._notifyTeamCreated()},render:function(){var e,t;return t=this.props.viewer.work_user,e=t.email.toLowerCase().split("@")[1],v(g,{ref:"modal",className:"invite-and-settings-modal",title:b("Invite your first team members!"),acceptButtonText:b("Continue"),onAccept:this._onCTAButtonClick,onDismiss:this._handleDismiss,onDismissCompleted:this.props.onDismissCompleted,autoClose:!1,submitting:this.state.submitting,acceptButtonDisabled:this.state.submitting||!this.state.canProceed},y.div({className:"invite-form-label"},b("Invite Members")),v(m,{ref:"inviteForm",customClass:"invite-form",user:t,invitationContext:m.InvitationContexts.existingTeam,populatedContacts:this.props.suggested_contacts,onChange:this._checkCanProceed,memberInviteLimit:this.props.memberInviteLimit,maxTeamSize:this.props.maxTeamSize}),this.props.canSetTeamRequestMembershipPolicy?v(c,{labelVariant:f.FOR_ADMIN,teamDomain:e,valueLink:this.linkState("requestMembershipPolicy")}):null)}})})}.call(this),function(){define("modules/clean/teams/limited_team_settings_modal",["external/react","modules/core/browser","modules/clean/react/button","modules/core/i18n","modules/clean/ajax","modules/clean/analytics","modules/clean/react/input","modules/clean/react/modal","modules/clean/teams/constants","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/teams/notes_link_policy_select","modules/clean/teams/request_membership_policy_select","modules/clean/teams/modals/delete_team_modal","modules/constants/python"],function(e,t,s,n,a,o,r,i,l,u,m,c,d,p){var h,g,f,_,b,v,y,w,C,M,N;return w=s.button,y=n._,v=o.TeamsWebActionsLogger,f=i.Modal,_=l.REQUEST_MEMBERSHIP_POLICY_LABEL_VARIANTS,h=d.DeleteTeamModal,b=p.TRADEMARK_BUSINESS,M=e.DOM,C=e.createElement,N=e.PropTypes,g=e.createClass({mixins:[e.addons.LinkedStateMixin],displayName:"LimitedTeamSettingsModal",propTypes:{onUpdated:N.func,canChangeTeamName:N.bool.isRequired,canDeleteTeam:N.bool.isRequired,canSetTeamRequestMembershipPolicy:N.bool.isRequired,canChangeNotesLinkPolicy:N.bool,teamDomain:N.string.isRequired,teamId:N.number.isRequired,initialTeamName:N.string.isRequired,initialTeamFullName:N.string.isRequired,initialTeamRequestMembershipPolicy:N.number.isRequired,initialNotesLinkPolicy:N.number.isRequired},getInitialState:function(){return{submitting:!1,errors:{},teamName:this.props.initialTeamName,teamRequestMembershipPolicy:this.props.initialTeamRequestMembershipPolicy,notesLinkPolicy:this.props.initialNotesLinkPolicy}},_teamNameHasChanged:function(){return this.state.teamName.trim()!==this.props.initialTeamName},_teamPolicyHasChanged:function(){return this.state.teamRequestMembershipPolicy!==this.props.initialTeamRequestMembershipPolicy},_notesPolicyHasChanged:function(){return this.state.notesLinkPolicy!==this.props.initialNotesLinkPolicy},_canProceed:function(){return!this.state.submitting&&(""!==this.state.teamName.trim()&&this.props.canChangeTeamName&&this._teamNameHasChanged()||this.props.canSetTeamRequestMembershipPolicy&&this._teamPolicyHasChanged())||this.props.canChangeNotesLinkPolicy&&this._notesPolicyHasChanged()},_onAjaxError:function(){return this.setState({submitting:!1})},_onClickSave:function(e){var s,n,o;e.preventDefault(),this.setState({submitting:!0}),o=function(e){return function(t){return e.props.canChangeTeamName&&e._teamNameHasChanged()?a.WebRequest({url:"/team/manage/rename",data:{team_id:e.props.teamId,orig_name:e.props.initialTeamName,orig_full_name:e.props.initialTeamFullName,new_name:e.state.teamName,full_name:e.state.teamName},error:function(t,s,n){return e.setState({errors:function(){try{return JSON.parse(n)}catch(e){}}()}),e._onAjaxError()},success:t}):"function"==typeof t?t():void 0}}(this),n=function(e){return function(t){return e.props.canSetTeamRequestMembershipPolicy&&e._teamPolicyHasChanged()?a.WebRequest({url:"/team/manage/set_request_membership_policy",data:{new_team_policy:e.state.teamRequestMembershipPolicy},error:e._onAjaxError,success:t}):"function"==typeof t?t():void 0}}(this),s=function(e){return function(t){return e.props.canChangeNotesLinkPolicy&&e._notesPolicyHasChanged()?a.WebRequest({url:"/team/manage/set_paper_link_policy",
data:{new_link_policy:e.state.notesLinkPolicy},error:e._onAjaxError,success:t}):"function"==typeof t?t():void 0}}(this),o(function(e){return function(){return n(function(){return s(function(){var s;"function"==typeof(s=e.props).onUpdated&&s.onUpdated(),t.reload()})})}}(this))},_onDismissModal:function(){v.log("canceled_update_team_settings")},_renderCTA:function(){return C(u,{upsellText:y("Looking for more advanced settings? Upgrade to get more security features and admin controls."),upgradeButtonText:y("Upgrade to %(trademark_business)s").format({trademark_business:b}),redirectQuery:{tk:"team_settings",_camp:"modal"}})},_renderTeamNameForm:function(){return[M.label({className:"limited-team-settings-modal-content__company-name-label",htmlFor:"limited-team-settings-modal-content__company-name-input"},y("Company name")),C(r.text,{label:y("Company or organization name"),className:"limited-team-settings-modal-content__company-name-input",id:"limited-team-settings-modal-content__company-name-input",valueLink:this.linkState("teamName"),error:this.state.errors.new_name})]},_renderMembershipApprovalPolicyForm:function(){return C(c,{labelVariant:_.FOR_ADMIN,teamDomain:this.props.teamDomain,valueLink:this.linkState("teamRequestMembershipPolicy")})},_renderNotesLinkPolicyForm:function(){return C(m,{teamDomain:this.props.teamDomain,valueLink:this.linkState("notesLinkPolicy")})},_renderDeleteTeamButton:function(){return M.div({className:"delete-team-button-section"},M.button({className:"delete-team-button button-tertiary",onClick:this._deleteTeam},y("Delete team")))},_deleteTeam:function(){return f.showInstance(C(h,{teamName:this.state.teamName,teamId:this.props.teamId}))},render:function(){return C(f,{title:y("Team settings"),acceptButtonText:y("Save settings"),dismissButtonText:y("Cancel"),onAccept:this._onClickSave,onDismiss:this._onDismissModal,acceptButtonDisabled:!this._canProceed(),submitting:this.state.submitting,altAction:this._renderCTA(),className:"limited-team-settings-modal",ref:"modal"},M.div({className:"limited-team-settings-modal-content"},this.props.canChangeTeamName?this._renderTeamNameForm():void 0,this.props.canSetTeamRequestMembershipPolicy?this._renderMembershipApprovalPolicyForm():void 0,this.props.canChangeNotesLinkPolicy?this._renderNotesLinkPolicyForm():void 0),this.props.canDeleteTeam?this._renderDeleteTeamButton():void 0)}})})}.call(this),function(){define("modules/clean/teams/limited_team_tooltip_runner",["jquery","external/underscore","external/react","external/immutable","modules/core/browser","modules/core/i18n","modules/core/exception","modules/clean/ajax","modules/clean/react/bubble","modules/clean/react/css","modules/clean/react/sprite","modules/clean/react/button","modules/clean/static_urls"],function(e,t,s,n,a,o,r,i,l,u,m,c,d){var p,h,g,f,_,b,v,y,w,C;return f=o._,b=r.assert,C=d.static_url,y=s.DOM,v=s.createElement,w=s.PropTypes,g=n.Record({heading:"",body:"",buttonText:"",arrowDirection:null,cssSelector:"",imageHref:"",imageHrefHires:"",imageHeight:"",imageWidth:null,onButtonClick:null,onButtonClickImmediate:null}),h=function(e,s,n){var a,o;return o=t(e.tooltipSpecs).keys(),t(e[s]).difference(o).length&&(a="Invalid prop "+s+" supplied to "+n+". All "+s+" values must exist in tooltipSpecs"),e[s]||(a="Prop "+s+" must be supplied to "+n+"."),a?new Error(a):void 0},_=s.createClass({BUBBLE_WIDTH:250,displayName:"LimitedTeamTooltipRunner",propTypes:{initialServerStep:w.number.isRequired,serverStepOffset:w.number.isRequired,tooltipSpecs:w.objectOf(w.instanceOf(g)).isRequired,tooltipSpecOrder:h,lastTooltipDismissedCb:w.func,onStepAdvancedCb:w.func},getInitialState:function(){return{currentStepNumber:this.props.initialServerStep-this.props.serverStepOffset,waitingForServerResponse:!1}},componentDidMount:function(){return"complete"===document.readyState?this._initBubbleTracking():e(window).load(this._initBubbleTracking)},componentDidUpdate:function(){return this._setBubbleLocation()},componentWillUnmount:function(){return e(window).off("resize",this._setBubbleLocation)},_initBubbleTracking:function(){return this._setBubbleLocation(),e(window).resize(this._setBubbleLocation)},_specForStepNumber:function(e){return this.props.tooltipSpecs[this.props.tooltipSpecOrder[e]]},_recordStepSeen:function(e){return i.WebRequest({url:"/team/onboarding_event",data:{stage:this.state.currentStepNumber+this.props.serverStepOffset},success:e})},_recordAndAdvance:function(){var e;if(!this.state.waitingForServerResponse)return this.setState({waitingForServerResponse:!0}),e=this._specForStepNumber(this.state.currentStepNumber),"function"==typeof e.onButtonClickImmediate&&e.onButtonClickImmediate(),this._recordStepSeen(function(t){return function(s){var n,a;return n=parseInt(JSON.parse(s).next_state),t.state.currentStepNumber===t.props.tooltipSpecOrder.length-1?t.props.lastTooltipDismissedCb(n):(a=function(){var e;return t.setState({currentStepNumber:n-t.props.serverStepOffset,waitingForServerResponse:!1}),"function"==typeof(e=t.props).onStepAdvancedCb?e.onStepAdvancedCb(n):void 0},e.onButtonClick?e.onButtonClick(a):a())}}(this))},_setBubbleLocation:function(){var t,s,n,a,o,r,i,u,m,c,d,p,h,g,f;if(h=this._specForStepNumber(this.state.currentStepNumber),b((d=h.arrowDirection)===l.ARROW.TOP||d===l.ARROW.LEFT||d===l.ARROW.LEFT_TOP,"trying to setBubbleLocation with unsupported arrow direction. Please add code for computing bubble location"),t=e(".react-bubble-box__arrow-border"),n=e(h.cssSelector),n.length){switch(s=e(this.refs.tooltipBubble.getDOMNode()),p=n.offset(),r=s.offsetParent().offset(),m=p.left-r.left,c=p.top-r.top,u=function(e){return Math.floor(e.outerWidth()/2)},i=function(e){return Math.floor(e.outerHeight()/2)},h.arrowDirection){case l.ARROW.TOP:a=t.outerHeight(),a>40&&(a=18),g=m-u(s)+u(n),f=c+n.outerHeight()+a;break;case l.ARROW.LEFT:o=t.outerWidth(),o>40&&(o=18),g=m+n.outerWidth()+o,f=c-i(s)+i(n);break;case l.ARROW.LEFT_TOP:o=t.outerWidth(),o>40&&(o=18),g=m+n.outerWidth()+o,f=c-i(n)}return s.css({top:f,left:g,visibility:"visible"})}},render:function(){var e;return e=this._specForStepNumber(this.state.currentStepNumber),y.div({className:"limited-team-tooltips"},v(l,{ref:"tooltipBubble",arrow:e.arrowDirection,className:"limited-team-tooltips__bubble",style:{position:"absolute",width:this.BUBBLE_WIDTH,visibility:"hidden"}},y.div({className:"limited-team-tooltips__bubble-contents"},y.img({src:C(e.imageHref),srcHiRes:C(e.imageHrefHires||e.imageHref),className:"limited-team-tooltips__bubble-image",width:e.imageWidth||.84*this.BUBBLE_WIDTH,height:e.imageHeight}),y.h2({},e.heading),y.p({},e.body),y.button({className:"button-primary limited-team-tooltips__bubble-button",onClick:this._recordAndAdvance},e.buttonText))))}}),p=u(_,["/static/css/react/bubble_box-vflhusCtq.css"]),{LimitedTeamTooltipRunner:p,TooltipSpec:g}})}.call(this),function(){define("modules/clean/teams/limited_team_tooltips",["external/react","modules/clean/react/bubble","modules/core/browser","modules/core/i18n","modules/clean/teams/limited_team_tooltip_runner"],function(e,t,s,n,a){var o,r,i,l,u,m;return l=n._,o=a.LimitedTeamTooltipRunner,i=a.TooltipSpec,u=e.createElement,m=e.PropTypes,r=e.createClass({displayName:"LimitedTeamTooltips",propTypes:{onboardingState:m.number.isRequired,lastTooltipDismissedCb:m.func},ONBOARDING_TOOLTIP_INFO:{TEAM_TAB:new i({heading:l("Manage your team"),body:l("Here’s where you can invite people to the team, remove people, change the team name, and more!"),arrowDirection:t.ARROW.LEFT,buttonText:l("Next"),cssSelector:".team-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage-vflXw6tGQ.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_manage@2x-vflS2wbhg.png",imageHeight:130,onButtonClick:function(){return s.redirect("/team")}}),INVITE_MEMBERS:new i({heading:l("Invite more people"),body:l("Here’s where you can send invites to add more people to your team."),arrowDirection:t.ARROW.TOP,buttonText:l("Next"),cssSelector:".invite-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite-vflwGI3rs.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_invite@2x-vflujxc7r.png",imageHeight:130}),GROUPS:new i({heading:l("Create and view groups"),body:l("Keep things organized by adding people to a group or creating a new one."),arrowDirection:t.ARROW.TOP,buttonText:l("Next"),cssSelector:"#tab_team-tab-groups",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups-vflUdtiBT.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_groups@2x-vflYWShtX.png",imageHeight:130}),SETTINGS:new i({heading:l("Team settings"),body:l("Customize details like your company name, Paper sharing settings, and more."),arrowDirection:t.ARROW.TOP,buttonText:l("Next"),cssSelector:".settings-button",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings-vflTnLAOr.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_settings@2x-vflClprJl.png",imageHeight:130}),PAPER:new i({heading:l("Dropbox Paper"),body:l("Check out the best way to create and build on ideas with your team."),arrowDirection:t.ARROW.LEFT,buttonText:l("Next"),cssSelector:".composer-nav-item",imageHref:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper-vflQyNMh5.png",imageHrefHires:"/static/images/teams/fastrak-rainbow/illo_tooltips_paper@2x-vfl7TJoJA.png",imageHeight:130,onButtonClickImmediate:function(){return s.open_tab("/paper")}})},BUBBLE_INFO_ARRAY:["TEAM_TAB","INVITE_MEMBERS","GROUPS","SETTINGS","PAPER"],render:function(){return u(o,{initialServerStep:this.props.onboardingState,lastTooltipDismissedCb:this.props.lastTooltipDismissedCb,serverStepOffset:2,tooltipSpecs:this.ONBOARDING_TOOLTIP_INFO,tooltipSpecOrder:this.BUBBLE_INFO_ARRAY})}})})}.call(this),function(){define("modules/clean/teams/modals/account_pair_suggest_modal",["external/react","modules/core/browser","modules/core/i18n","modules/core/uri","modules/clean/analytics","modules/clean/react/modal"],function(e,t,s,n,a,o){var r,i,l,u,m,c,d;return u=s._,l=a.TeamsWebActionsLogger,i=o.Modal,c=e.DOM,m=e.createElement,d=e.PropTypes,r=e.createClass({displayName:"AccountPairSuggestModal",propTypes:{suggested_email:d.string,current_email:d.string,cont:d.string},componentDidMount:function(){return l.log("account_pair_suggest_modal_shown")},_onContinue:function(){return t.redirect(new n({path:"/team/join/new_pair",query:this.props.cont?{cont:this.props.cont}:{}}))},render:function(){return m(i,{title:u("Connect your personal Dropbox"),acceptButtonText:u("Continue"),onAccept:this._onContinue,className:"account-pair-suggest-modal"},c.div({className:"account-pair-suggest-modal-content"},u("You can connect a personal Dropbox (%(suggested_email)s) with your new work Dropbox (%(current_email)s) to sync both Dropboxes to all your devices. You can easily switch between them without signing in and out, on both web and mobile.").format({suggested_email:this.props.suggested_email,current_email:this.props.current_email})))}})})}.call(this),function(){define("modules/clean/teams/modals/delete_team_modal",["external/react","modules/core/i18n","modules/core/notify","modules/core/browser","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,a,o,r){var i,l,u,m,c,d;return u=t._,l=o.Modal,m=e.DOM,c=e.PropTypes,d=r.get_viewer(),i=e.createClass({displayName:"DeleteTeamModal",propTypes:{teamName:c.string.isRequired,teamId:c.number.isRequired},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),a.WebRequest({url:"/team/manage/delete",data:{team_id:this.props.teamId,_subject_uid:d.work_user.id},complete:function(e){return function(){return e.setState({submitting:!1})}}(this),success:function(){return s.success(u("You successfully deleted the team.")),n.redirect("/home")}})},render:function(){var t;return t=u("The %(team_name)s team will be permanently deleted and all members will be removed. Your team’s folders will be converted to shared folders, nested shared folders will be flattened and your %(team_name)s groups will be deleted. Every member’s account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),e.createElement(l,{title:u("Delete team?"),acceptButtonText:u("Delete"),dismissButtonText:u("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},t)}}),{DeleteTeamModal:i}})}.call(this),function(){define("modules/clean/teams/modals/leave_team_modal",["external/react","modules/core/i18n","modules/core/notify","modules/core/browser","modules/clean/ajax","modules/clean/react/modal","modules/clean/viewer"],function(e,t,s,n,a,o,r){var i,l,u,m,c,d,p,h;return c=t._,m=o.Modal,d=e.DOM,p=e.PropTypes,h=r.get_viewer(),u=e.createClass({displayName:"LeaveTeamModal",propTypes:{teamName:p.string,canHaveAdminUi:p.bool},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),a.WebRequest({url:"/team/manage/leave",data:{user_id:h.work_user.id},complete:function(e){return function(){return e.setState({submitting:!1})}}(this),success:function(){return s.success(c("You left the team.")),n.redirect("/team")}})},render:function(){var t;return t=this.props.canHaveAdminUi?c("You’ll lose access to all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}):c("You’ll lose access to the %(team_name)s team folder and all %(team_name)s groups. Your account will be converted to a personal Dropbox.").format({team_name:this.props.teamName}),e.createElement(m,{title:c("Leave team?"),acceptButtonText:c("Leave team"),dismissButtonText:c("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},t)}}),i=e.createClass({displayName:"LeaveTeamAsSoleLimitedAdminWarningModal",propTypes:{teamName:p.string},render:function(){return e.createElement(m,{title:c("You must give admin permissions to someone else"),acceptButtonText:c("I understand"),submitting:!1,autoClose:!0},c("Since you’re the only admin of %(team_name)s, you need to give someone else on your team admin permissions before you leave the team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”.").format({team_name:this.props.teamName}))}}),l=e.createClass({displayName:"LeaveTeamButton",propTypes:{teamName:p.string,showWarningOnLeaveTeam:p.bool,canHaveAdminUi:p.bool},showLeaveTeamModal:function(){return this.props.showWarningOnLeaveTeam?m.showInstance(e.createElement(i,{teamName:this.props.teamName})):m.showInstance(e.createElement(u,{teamName:this.props.teamName,canHaveAdminUi:this.props.canHaveAdminUi}))},render:function(){return d.button({className:"leave-team-button",onClick:this.showLeaveTeamModal},c("Leave team"))}}),{LeaveTeamModal:u,LeaveTeamButton:l}})}.call(this),function(){var e=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};define("modules/clean/teams/modals/limited_team_file_upload_modal",["external/react","external/underscore","modules/core/i18n","modules/core/browser","modules/core/uri","modules/clean/ajax","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/button","modules/clean/react/file_uploader/actions","modules/clean/react/file_uploader/uploader","modules/clean/react/modal","modules/clean/static_urls","modules/clean/teams/constants","modules/clean/teams/limited_team_tooltips","modules/clean/teams/sign_up_for_team/desktop_client_install_modal","modules/clean/react/sprite","modules/clean/react/table","modules/clean/viewer","modules/core/notify"],function(t,s,n,a,o,r,i,l,u,m,c,d,p,h,g,f,_,b,v,y){var w,C,M,N,T,S,A,k,R,D,x,P,I,E,L,O,q;return x=n._,R=i.TeamsWebActionsLogger,I=u.button,D=m.UploaderActions,N=c.FileUploader,A=d.Modal,q=p.static_url,w=h.ADMIN_ONBOARDING_STATES,C=f.DesktopClientInstallModal,L=t.DOM,E=t.createElement,O=t.PropTypes,P=function(e,t){var s,n,a;n={};for(a in e)s=e[a],n[a]=s.bind(t);return n},T=t.createClass({displayName:"LimitedTeamFileUploadIntroModal",propTypes:{onCloseCallback:O.func,buttonText:O.string},onClose:function(e){return e.preventDefault(),this.props.onCloseCallback()},componentDidMount:function(){return R.log("welcome_team_modal")},render:function(){return A({acceptButtonText:this.props.buttonText,clickOutToClose:!1,onAccept:this.onClose,onDismiss:this.onClose,width:720,style:"clean",className:"limited-team-file-upload-modal",ref:"intro-modal"},L.div({className:"limited-team-file-upload-modal-content u-mar-top-l"},L.img({src:q("/static/images/teams/onboarding/admin-onboarding-modal-vflV4rJnP.png"),srcHiRes:q("/static/images/teams/onboarding/admin-onboarding-modal@2x-vflDinfiz.png"),className:"limited-team-file-upload-modal-content__image"}),L.h1({},x("Welcome to your Team Dropbox")),L.p({className:"limited-team-file-upload-modal-content-description"},x("A centralized place for you and your team to instantaneously share files with each other"))))}}),M=t.createClass({displayName:"FileTransferModal",propTypes:{files:O.arrayOf(O.string),teamFolderFqPath:O.string,onModalDismissed:O.func},getDefaultProps:function(){return{files:[]}},getInitialState:function(){return{transferredFile:!1}},componentWillUnmount:function(){var e;return"function"==typeof(e=this.props).onModalDismissed?e.onModalDismissed():void 0},moveFiles:function(e){var t;return t=o({path:"/cmd/move",query:{long_running:1}}),r.WebRequest({url:t,data:{to_path:this.props.teamFolderFqPath,files:e,_subject_uid:v.get_viewer().work_user},success:function(e){return function(t){var s;return e.setState({transferredFile:!0}),y.success(x("Successfully transferred files to your Team Dropbox!")),null!=(s=e.refs.singleDirectoryFileListing)?s.forceRefresh():void 0}}(this)})},render:function(){return A({buttonComponent:L.span({},""),clickOutToClose:!0,onAccept:this._uploadSelectedFiles,width:720,title:x("Add files to your Team Folder"),ref:"fileTransferModal",className:"file-transfer-modal"},L.div({},L.div({className:"file-transfer-modal__text"},L.p({className:"u-mar-bottom-l"},x("Help your team to hit the ground running by moving some files into your Team folder. That way when they join, they have all of the the files they need to get work done.")),L.div({className:"file-transfer-modal__text--sprite u-mar-bottom-l u-mar-left-m"},E(_,{group:"web",name:"folder_paper_team_32",alt:"generic folder icon"}))),E(k,{ref:"singleDirectoryFileListing",className:"single-directory-file-listing",path:"/",excludedFileFqPaths:[this.props.teamFolderFqPath],primaryButtonText:x("Move Files to Team Folder"),primaryButtonCallback:this.moveFiles,secondaryButtonText:x(this.state.transferredFile?"All done":"Cancel"),secondaryButtonCallback:function(e){return function(){return e.refs.fileTransferModal.close()}}(this)})))}}),k=t.createClass({displayName:"SingleDirectoryFileListing",propTypes:{path:O.string,excludedFileFqPaths:O.arrayOf(O.string),primaryButtonText:O.string,primaryButtonCallback:O.func,secondaryButtonText:O.string,secondaryButtonCallback:O.func},getDefaultProps:function(){return{path:"/",primaryButtonCallback:function(){},excludedFileFqPaths:[]}},columnTypes:{sprite:function(e){return{field:"sprite",classes:{"file-transfer-modal-table__sprite-col":!0},header:"",width:e,sortable:!1,render:function(e){return E(_,{group:"web",name:e.icon,alt:x("file icon")})}}},filename:function(e){return{field:"filename",classes:{"file-transfer-modal-table__filename-col":!0},header:"",width:e,sortable:!1,render:function(e){return function(t){var s;return s=t.filename.substring(e.props.path.length),L.span({},s)}}(this)}},selectButton:function(e){return{field:"selectButton",classes:{"file-transfer-modal-table__select-col":!0},header:"",width:e,sortable:!1,render:function(e){return function(t){return L.button({className:"button-as-link"},x(e.state.files[t.filename]?"Unselect":"Select"))}}(this)}}},selectClicked:function(e){var t,n;return t=e.filename,n=this.state.files,n[t]=!n[t],this.setState({buttonEnabled:s.any(s.values(n)),files:n})},componentWillMount:function(){return this.columnTypes=P(this.columnTypes,this)},componentDidMount:function(){return this.refs.fileslist.forceRefresh()},getInitialState:function(){return{files:{},buttonEnabled:!1}},forceRefresh:function(){return this.refs.fileslist.forceRefresh()},rowClass:function(e){var t;return t=this.state.files[e.filename],t?{"file-transfer-modal-table__row--selected":!0}:{"file-transfer-modal-table__row--unselected":!0}},primaryButton:function(){return E(I,{disabled:!this.state.buttonEnabled,className:"file-transfer-modal__button--primary u-mar-right-s",onClick:this.submitClicked},this.props.primaryButtonText)},secondaryButton:function(){return E(I,{className:"file-transfer-modal__button--secondary",importance:"tertiary",onClick:this.props.secondaryButtonCallback},this.props.secondaryButtonText)},submitClicked:function(){var e,t,s;return this.setState({buttonEnabled:!1}),s=[function(){var e;e=[];for(t in this.state.files)this.state.files[t]&&e.push(t);return e}.call(this)],"function"==typeof(e=this.props).primaryButtonCallback?e.primaryButtonCallback(s):void 0},render:function(){var t,s;return s=62,t=100,L.div({},L.div({className:"file-transfer-modal__table-wrapper-div"},E(b,{ref:"fileslist",classes:{"grey-style":!0,"file-transfer-modal-table":!0},headerClasses:{"file-transfer-modal-table__header":!0},rowClasses:this.rowClass,columns:[this.columnTypes.sprite(s),this.columnTypes.filename(600-s-t),this.columnTypes.selectButton(t)],initialData:{rows:[],total:0},initialSortColumn:1,rowsPerPage:999999,loadingIndicator:q("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),onRequestData:function(t){return function(s,n){var a,o;return a=v.get_viewer().work_user,o="/browse"+t.props.path,r.WebRequest({url:o,data:{_subject_uid:a},success:function(s){var a,o,r,i,l,u,m,c,d;for(s=JSON.parse(s),o=[],r={},m=s.file_info,l=0,u=m.length;u>l;l++)a=m[l],c=a.fq_path,e.call(t.props.excludedFileFqPaths,c)<0&&(i=a.fq_path,d=i in t.state.files?t.state.files[i]:!1,o.push({filename:i,selected:d,icon:a.icon}),r[i]=d,t.setState({files:r}));return n(null,{rows:o,total:o.length})}})}}(this),onRowClicked:function(e){return function(t){return e.selectClicked(t)}}(this)})),L.div({style:{float:"right"}},this.primaryButton(),this.secondaryButton()))}}),S=t.createClass({displayName:"LimitedTeamFileUploadManager",propTypes:{path:O.string,modalVariant:O.oneOf(["UPLOAD","TRANSFER"]),transferPath:O.string,teamFolderFqPath:O.string,showDesktopClientInstallModal:O.bool,createUploaderComponent:O.bool,installPageInformation:O.object,showModalOnPageLoad:O.bool,initialOnboardingState:O.number},getDefaultProps:function(){return{transferPath:"/",modalVariant:"TRANSFER",createUploaderComponent:!0,showModalOnPageLoad:!1,path:""}},getInitialState:function(){return{onboardingState:this.props.initialOnboardingState+1}},componentDidMount:function(){return D.setPath({path:this.props.path||"/"}),D.setUser({user:v.get_viewer().work_user}),this.props.showModalOnPageLoad&&this.state.onboardingState===w.UPLOAD_MODAL?this.showIntroModal():void 0},_shouldShowBubbles:function(){var e,t;return this.onBrowsePage()?w.UPLOAD_MODAL<(e=this.state.onboardingState)&&e<w.INVITATION_TOOLTIP:w.TEAM_TAB_TOOLTIP<(t=this.state.onboardingState)&&t<w.DONE},showIntroModal:function(){var e;return e=x("Next"),this.state.onboardingState<=w.UPLOAD_MODAL?A.showInstance(E(T,{onCloseCallback:this.onIntroModalDismissed,buttonText:e})):void 0},onFileUploadComplete:function(){return r.WebRequest({url:"/team/onboarding_event",data:{stage:w.UPLOADED_FILE},success:function(){},error:function(){}})},onIntroModalDismissed:function(){switch(r.WebRequest({url:"/team/onboarding_event",data:{stage:w.UPLOAD_MODAL},complete:function(e){return function(){return!e.props.createUploaderComponent&&e.onBrowsePage()?e.onUploadModalDismissed():void 0}}(this)}),this.props.modalVariant){case"UPLOAD":return this.refs.fileUploader?this.refs.fileUploader.showModal():N.showModal(),R.log("files_upload_modal");case"TRANSFER":return R.log("files_transfer_modal"),A.showInstance(E(M,{teamFolderFqPath:this.props.path,onModalDismissed:this.onUploadModalDismissed}))}},onUploadModalDismissed:function(){var e;return this.onBrowsePage()?this.setState({onboardingState:this.state.onboardingState+1}):(e=o({path:"/home"+this.props.path}),a.redirect(e))},onBrowsePage:function(){var e;return e=a.get_uri().getPath(),e.indexOf("/home")>=0||e.indexOf("/work")>=0},onLastTooltipDismissed:function(e){return this.setState({onboardingState:e}),this.props.showDesktopClientInstallModal?A.showInstance(E(C,{installPageInformation:this.props.installPageInformation,unmountCallback:this.onClientInstallModalDismissed})):void 0},render:function(){var e;return"UPLOAD"===this.props.modalVariant&&this.props.createUploaderComponent&&this.state.onboardingState<=w.UPLOAD_MODAL&&(e=E(N,{ref:"fileUploader",dragAndDropEnabled:!1,clickOutToClose:!0,shouldShowDestinationLink:!1,onModalDismissed:this.onUploadModalDismissed,onFileUploadComplete:this.onFileUploadComplete})),L.div({className:"teams-page-file-upload-manager"},e?e:void 0,this._shouldShowBubbles()?E(g,{onboardingState:this.state.onboardingState,lastTooltipDismissedCb:this.onLastTooltipDismissed}):void 0)}}),{LimitedTeamFileUploadManager:S}})}.call(this),function(){define("modules/clean/teams/modals/limited_team_max_size_modal",["external/react","modules/core/browser","modules/core/uri","modules/core/user_i18n","modules/core/i18n","modules/clean/react/react_i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/limited_team_invite_form","modules/clean/avatar/avatar_with_default","modules/clean/avatar/photo_avatar","modules/clean/avatar/initials_avatar_with_color","modules/clean/avatar/size"],function(e,t,s,n,a,o,r,i,l,u,m,c,d,p){var h,g,f,_,b,v,y,w;return b=a._,_=o.R_,f=l.Modal,h=p.AVATAR_DIMENSION_BY_SIZE,v=e.createElement,y=e.DOM,w=e.PropTypes,g=e.createClass({displayName:"LimitedTeamMaxSizeModal",propTypes:{showAdminVersion:w.bool,teamMembersLimit:w.number,contacts:w.arrayOf(w.shape({display_name:w.string.isRequired,email:w.string.isRequired,account_photo_url:w.string}))},getInitialState:function(){return{submitting:!1}},onButtonClick:function(){return this.props.showAdminVersion?this.redirectToUpgrade():this.notifyAdmins()},notifyAdmins:function(){return this.setState({submitting:!0}),i.WebRequest({url:"/team/notify_admins_max_team_size_upsell_modal",complete:function(e){return function(){return e.setState({submitting:!1})}}(this),success:function(){return f.close(),r.success(b("We’ve notified your admins."))},error:function(){return r.error()}})},redirectToUpgrade:function(){var e;return e={tk:this.props.teamMembersLimit,camp:"modal"},t.redirect(s({path:"/team/upgrade",query:e}))},onDismissModal:function(){return f.close()},facePileWithLock:function(){var e;return y.div({className:"limited-team-max-size-modal__avatars"},function(){var t,s,a,o;for(a=this.props.contacts.slice(0,5),o=[],t=0,s=a.length;s>t;t++)e=a[t],o.push(y.div({className:"limited-team-max-size-modal__contact-avatar",key:"contact-"+e.email},v(m,{dimension:h.LARGE,photoUrl:e.account_photo_url,defaultAvatar:v(d,{dimension:h.LARGE,name:e.display_name,initials:n.getInitials(e.display_name||e.email),shape:"CIRCLE"})})));return o}.call(this),y.div({className:"limited-team-max-size-modal__contact-avatar"},v(c,{dimension:h.LARGE,photoUrl:"/static/images/teams/private_cir@2x-vflv746EN.png"})))},render:function(){var e;return e=b(this.props.showAdminVersion?"Upgrade to Dropbox Business":"Notify your admins"),v(f,{title:b("You’ve reached the maximum team size"),acceptButtonText:e,acceptButtonDisabled:this.state.submitting,autoClose:!1,onAccept:this.onButtonClick,onDismiss:this.onDismissModal,submitting:this.state.submitting,className:"limited-team-max-size-modal"},this.facePileWithLock(),_({max_size:this.props.teamMembersLimit},'You’re currently on the free plan which only allows you to add up to %(max_size)s members. Upgrade to Dropbox Business to add as many members as you want! <br/> <br/> Dropbox Business also gives you all the space you need, advanced security features, and dedicated live support. <a href="/team/upgrade?tk=%(max_size)s&_camp=modal">Learn more</a>.'))}})})}.call(this),function(){define("modules/clean/teams/modals/remove_member_modal",["external/react","external/purify","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/constants","modules/clean/react/select","modules/clean/react/sprite","modules/clean/react/teams/modals/limited_team_upsell_modal_banner","modules/clean/viewer","modules/clean/analytics","modules/constants/python"],function(e,t,s,n,a,o,r,i,l,u,m,c,d){var p,h,g,f,_,b,v,y,w,C;return b=s._,h=o.Modal,p=r.JOIN_STATES,_=c.TeamsWebActionsLogger,f=d.TRADEMARK_BUSINESS,y=e.DOM,w=e.PropTypes,v=e.createElement,C=m.get_viewer(),g=e.createClass({displayName:"RemoveMemberModal",propTypes:{teamName:w.string,showUpsellVariant:w.string,user:w.object,onRemoved:w.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return _.log("teams_click_remove_member_confirm",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:C.team_id}),this.setState({submitting:!0}),a.WebRequest({url:this.props.user.join_request_status?"/team/join_request/reject":"/team/manage/kick",data:{user_id:this.props.user.user_id},complete:function(e){return function(){return e.isMounted()?e.setState({submitting:!1}):void 0}}(this),success:function(e){return function(){var t;return e.props.user.team_join_state===p.ACTIVE?n.success(b("Member removed.")):n.success(b("Pending member removed.")),h.close(),"function"==typeof(t=e.props).onRemoved?t.onRemoved():void 0}}(this)})},onShow:function(){return _.log("teams_seen_remove_member_modal",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:C.team_id})},onDismiss:function(){return _.log("teams_click_remove_member_cancel",{user_id:this._getSignedInUser().id,user_being_removed_id:this.props.user.user_id,user_being_removed_join_state:this.props.user.team_join_state,variant:this.props.showUpsellVariant?"VARIANT":"CONTROL",team_id:C.team_id})},getNameToUse:function(e){return e.display_name?b("%(user_name)s (%(user_email)s)").format({user_name:e.display_name,user_email:e.email}):b("%(user_email)s").format({user_email:e.email})},_getSignedInUser:function(){return C.work_user||C.personal_user},_renderCTA:function(){return v(u,{upsellText:b("Unlock the options to remote wipe and transfer files by upgrading to %(trademark_business)s").format({trademark_business:f}),upgradeButtonText:b("Upgrade to %(trademark_business)s").format({trademark_business:f}),redirectQuery:{tk:"remove_member",_camp:"modal"}})},render:function(){var e,s;return s=this.props.user.team_join_state===p.ACTIVE,e=this._getSignedInUser(),v(h,{title:b(s?"Remove member?":"Remove pending member?"),acceptButtonText:b("Remove"),dismissButtonText:b("Cancel"),submitting:this.state.submitting,autoClose:!1,altAction:this.props.showUpsellVariant&&s?this._renderCTA():null,onAccept:this.onAccept,onShow:this.onShow,onDismiss:this.onDismiss},y.div({className:"remove-member-modal-section"},y.div({className:"remove-member-modal-description"},s?this.props.user.is_admin?b("%(user_presented_name)s will lose access to all %(team_name)s groups. %(user_first_name)s’s account will be converted to a personal Dropbox.").format({user_first_name:t.sanitize(this.props.user.fname),user_presented_name:t.sanitize(this.getNameToUse(this.props.user)),user_email:t.sanitize(this.props.user.email),team_name:t.sanitize(this.props.teamName)}):b("%(user_presented_name)s will lose access to the %(team_name)s team folder and be removed from all %(team_name)s groups. %(user_first_name)s’s account will be converted to a personal Dropbox.").format({
user_first_name:t.sanitize(this.props.user.fname),user_presented_name:t.sanitize(this.getNameToUse(this.props.user)),user_email:t.sanitize(this.props.user.email),team_name:t.sanitize(this.props.teamName)}):b("%(user_presented_name)s will be removed from the members list. Any invitation or activation links you’ve sent will no longer work.").format({team_name:t.sanitize(this.props.teamName),user_presented_name:t.sanitize(this.getNameToUse(this.props.user))})),this.props.showUpsellVariant&&s?[y.div({className:"remove-member-modal-disabled-feature u-mar-top-m"},y.input({type:"checkbox",checked:!1,disabled:!0},b("Remote wipe this member’s %(team_name)s team files.").format({team_name:t.sanitize(this.props.teamName)}),y.a({className:"remove-member-modal-info",href:"/en/help/4227",target:"_blank"},v(l,{group:"web",name:"info"})))),y.div({className:"remove-member-modal-disabled-feature u-mar-top-m"},y.input({type:"checkbox",checked:!1,disabled:!0},b("Transfer this user’s files to"),y.a({className:"remove-member-modal-info",href:"/en/help/4228",target:"_blank"},v(l,{group:"web",name:"info"})))),v(i.input,{className:"remove-member-modal-transfer-files-select u-mar-top-xs u-mar-btm-m",value:0,"disable-errors":!0,isDisabled:!0},v(i.option,{value:0},e.display_name+" ("+e.email+")"))]:void 0))}}),{RemoveMemberModal:g}})}.call(this),function(){define("modules/clean/teams/modals/set_limited_admin_modals",["external/react","external/purify","modules/core/notify","modules/core/i18n","modules/clean/react/react_i18n","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/constants"],function(e,t,s,n,a,o,r,i){var l,u,m,c,d,p,h,g,f;return h=n._,c=a.R_,m=r.Modal,l=i.ADMIN_ROLE,g=e.DOM,f=e.PropTypes,u=e.createClass({displayName:"GiveLimitedAdminModal",propTypes:{targetUser:f.object,teamId:f.number,onSuccess:f.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),o.WebRequest({url:"/account/team/set_admin_status",data:{team_id:this.props.teamId,user_id:this.props.targetUser.user_id,on:"yes",role:l.LIMITED},success:function(e){return function(){return e.props.onSuccess(),m.close()}}(this),complete:function(e){return function(){return e.isMounted()?e.setState({submitting:!1}):void 0}}(this)})},render:function(){var t;return t=c({user_name:this.props.targetUser.display_name},'Are you sure you want to give admin permissions to %(user_name)s? All users with admin permissions will be able to upgrade this team to <a href="/business">Dropbox Business</a>.'),e.createElement(m,{title:h("Change Admin Permissions for %(user_name)s").format({user_name:this.props.targetUser.display_name}),acceptButtonText:h("Confirm"),dismissButtonText:h("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},g.div({},t))}}),d=e.createClass({displayName:"RemoveLimitedAdminModal",propTypes:{targetUser:f.object,teamId:f.number,removingOwnPermissions:f.bool,onSuccess:f.func},getInitialState:function(){return{submitting:!1}},onAccept:function(){return this.setState({submitting:!0}),o.WebRequest({url:"/account/team/set_admin_status",data:{team_id:this.props.teamId,user_id:this.props.targetUser.user_id,on:"no",role:l.NONE},success:function(e){return function(){return e.props.onSuccess(),m.close()}}(this),complete:function(e){return function(){return e.isMounted()?e.setState({submitting:!1}):void 0}}(this)})},render:function(){var t,s;return this.props.removingOwnPermissions?(s=h("Are you sure you no longer want admin permissions?"),t=h("If you remove your admin permissions, you’ll no longer be able to upgrade or delete your team, change team settings, or remove invited and existing users.")):(s=h("Remove admin permissions for %(user_name)s").format({user_name:this.props.targetUser.display_name}),t=c({user_name:this.props.targetUser.display_name},'%(user_name)s won’t be able to manage team settings, remove and un-invite users, or upgrade the team to <a href="/business">Dropbox Business</a>. Are you sure you want to continue?')),e.createElement(m,{title:s,acceptButtonText:h("Confirm"),dismissButtonText:h("Cancel"),submitting:this.state.submitting,autoClose:!1,onAccept:this.onAccept},g.div({},t))}}),p=e.createClass({displayName:"RemoveLimitedAdminWarningModal",render:function(){return e.createElement(m,{title:h("You must give admin permissions to someone else"),acceptButtonText:h("I understand"),submitting:!1,autoClose:!0},h("In order to remove your admin permissions, you must first give admin permissions to someone else on your team. You can do this by clicking the gear icon to the right of a team member’s name and selecting “Give admin permissions”."))}}),{GiveLimitedAdminModal:u,RemoveLimitedAdminModal:d,RemoveLimitedAdminWarningModal:p}})}.call(this),function(){define("modules/clean/teams/notes_link_policy_select",["external/react","modules/core/i18n","modules/clean/react/select","modules/clean/teams/constants"],function(e,t,s,n){var a,o,r,i,l,u,m,c;return l=t._,r=n.NOTES_LINK_POLICY_VALUES,o=n.NOTES_LINK_POLICY_LABELS,u=e.createElement,m=e.DOM,c=e.PropTypes,a=[r.TEAM,r.PUBLIC],i=e.createClass({displayName:"NotesLinkPolicySelect",propTypes:{teamDomain:c.string.isRequired,defaultValue:c.oneOf(a).isRequired,valueLink:c.shape({value:c.oneOf(a).isRequired,requestChange:c.func.isRequired}),onChange:c.func},render:function(){var e;return m.div({className:"notes-link-policy-select"},m.div({className:"notes-link-policy-select__label-wrapper"},m.label({className:"notes-link-policy-select__label"},l("Who do you want to be able to open links to Paper docs by default?"))),u(s.input,{className:"notes-link-policy-select__select","disable-errors":!0,defaultValue:this.props.defaultValue,valueLink:this.props.valueLink,onChange:this.props.onChange},function(){var t,n,r;for(r=[],t=0,n=a.length;n>t;t++)e=a[t],r.push(u(s.option,{value:e,key:e},o[e]));return r}()))}})})}.call(this),function(){define("modules/clean/teams/sign_up_for_team/desktop_client_install_modal",["external/react","jquery","modules/core/i18n","modules/core/browser","modules/core/uri","modules/clean/ajax","modules/clean/react/button","modules/clean/react/modal","modules/clean/react/react_i18n"],function(e,t,s,n,a,o,r,i,l){var u,m,c,d,p,h,g,f;return d=s._,p=r.button,m=i.Modal,c=l.R_,g=e.DOM,h=e.createElement,f=e.PropTypes,u=e.createClass({displayName:"DesktopClientInstallModal",propTypes:{installPageInformation:f.object,unmountCallback:f.func},componentWillUnmount:function(){return this.props.unmountCallback?this.props.unmountCallback():void 0},componentDidMount:function(){return t(".desktop-client-install-modal__offline-install-link").click(this.downloadClicked.bind(this,this.offlineURI()))},downloadClicked:function(e){return n.redirect(e)},onlineURI:function(){return a({path:"/downloading",query:{os:this.props.installPageInformation.os}})},offlineURI:function(){return this.onlineURI().updateQuery({full:1})},versionNo:function(){var e,t;return e=function(){switch(this.props.installPageInformation.os){case"lnx":return"Linux";case"win":return"Windows";case"mac":return"Mac"}}.call(this),t=this.props.installPageInformation.buildNo,d("%(client_version_number)s for %(platform)s",{comment:'version_number looks like "2.10.3", platform is "Windows" or "Mac" or "Linux"'}).format({client_version_number:t,platform:e})},renderTitle:function(){return g.h1({className:"desktop-client-install-modal__title u-mar-top-xl u-mar-bottom-m"},d("Get your Team Dropbox on your computer"))},renderText:function(){return g.p({className:"desktop-client-install-modal__text"},d("Download Dropbox and you’ll be ready to work with your team!"))},renderButton:function(){return h(p,{className:"desktop-client-install-modal__button u-mar-bottom-s",variant:"big",onClick:this.downloadClicked.bind(this,this.onlineURI())},d("Download"))},renderVersionNo:function(){return g.p({className:"desktop-client-install-modal__version-no u-mar-bottom-l u-font-meta"},this.versionNo())},renderOfflineLink:function(){return c({},'Or download the <a class="desktop-client-install-modal__offline-install-link">Offline Installer</a>')},render:function(){return h(m,{className:"desktop-client-install-modal",style:"clean",width:720,buttonComponent:g.span(),ref:"desktop-client-modal"},this.renderTitle(),this.renderText(),this.renderButton(),this.renderVersionNo(),this.renderOfflineLink())}}),{DesktopClientInstallModal:u}})}.call(this),function(){define("modules/clean/teams/suggest_invites_modal",["external/underscore","external/react","modules/core/i18n","modules/core/notify","modules/clean/ajax","modules/clean/react/modal","modules/clean/teams/limited_team_invite_form","modules/clean/viewer"],function(e,t,s,n,a,o,r,i){var l,u,m,c,d,p;return m=s._,l=o.Modal,c=t.createElement,d=t.DOM,p=i.get_viewer(),u=t.createClass({displayName:"SuggestInvitesModal",getInitialState:function(){return{canProceed:!1,submitting:!1}},_canProceed:function(){var e,t;return(null!=(e=this.refs.members)?e.areAllContactsValid():void 0)&&!(null!=(t=this.refs.members)?t.isEmpty():void 0)},onClickInvite:function(e){return e.preventDefault(),this.refs.members.getFinalData(function(e){return function(t){var s,o;return o=t.emails,s=e._canProceed(),e.setState({canProceed:s}),s?(e.setState({submitting:!0}),a.WebRequest({url:"/team/manage/suggest-members",data:{emails:o},complete:function(){return e.setState({submitting:!1})},success:function(){return n.success(m("Thanks for your suggestions! We’ve sent them to the team admin.")),e.refs.modal.close()}})):void 0}}(this))},onMembersFormChange:function(){return this.setState({canProceed:this._canProceed()})},render:function(){return c(l,{title:m("Suggest %(team_name)s team members").format({team_name:p.team_name}),acceptButtonText:m("Send suggestions"),dismissButtonText:m("Cancel"),onAccept:this.onClickInvite,acceptButtonDisabled:!this.state.canProceed,submitting:this.state.submitting,ref:"modal"},d.div({className:"suggest_invite_modal_notice"},m("We’ll email your suggestions to your team admin, so they can send out invitations.")),c(r,{ref:"members",user:p.work_user,onChange:this.onMembersFormChange,errorMessageSpaceFixed:!1,includeCustomMessage:!1,emailPlaceholder:m("Email addresses"),autofocusTokenizer:!0}))}})})}.call(this),function(){define("modules/clean/teams/team_page",["jquery","external/react","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri","modules/core/user_i18n","modules/clean/ajax","modules/clean/analytics","modules/clean/contacts/data","modules/clean/contacts/types","modules/clean/react/bubble","modules/clean/react/modal","modules/clean/react/sprite","modules/clean/react/bubble_menu","modules/clean/react/table","modules/clean/avatar/avatar_with_default","modules/clean/avatar/initials_avatar","modules/clean/avatar/style","modules/clean/react/button","modules/clean/react/dbox_app_promo","modules/clean/teams/cdm_mve_util","modules/clean/teams/constants","modules/clean/teams/limited_team_invite_and_settings_modal","modules/clean/teams/limited_team_invite_modal","modules/clean/teams/limited_team_settings_modal","modules/clean/teams/limited_team_tooltips","modules/clean/teams/suggest_invites_modal","modules/clean/teams/modals/account_pair_suggest_modal","modules/clean/teams/modals/leave_team_modal","modules/clean/teams/modals/remove_member_modal","modules/clean/teams/modals/set_limited_admin_modals","modules/clean/teams/modals/limited_team_file_upload_modal","modules/clean/teams/modals/limited_team_max_size_modal","modules/clean/teams/prop_types","modules/clean/viewer"],function(e,t,s,n,a,o,r,i,l,u,m,c,d,p,h,g,f,_,b,v,y,w,C,M,N,T,S,A,k,R,D,x,P,I,E,L){var O,q,U,G,B,j,W,F,H,z,V,J,Y,Q,K,X,Z,$,ee,te,se,ne,ae,oe;return $=n._,K=l.TeamsWebActionsLogger,G=u.Contact,z=d.Modal,q=h.BubbleMenu,U=h.BubbleMenuItem,se=b.colorValueForAvatarName,O=y.Actionable,W=C.JOIN_STATES,X=C.USER_TYPES,j=C.JOIN_REQUEST_STATUS,F=R.LeaveTeamModal,Y=D.RemoveMemberModal,B=x.GiveLimitedAdminModal,V=x.RemoveLimitedAdminModal,J=x.RemoveLimitedAdminWarningModal,H=P.LimitedTeamFileUploadManager,ne=t.DOM,te=t.createElement,oe=e.extend({},t.PropTypes,E),Z={},Z[X.PENDING_TEAM_ADMIN]=$("Team Admin"),Z[X.PENDING_ACCOUNTS_ADMIN]=$("User Management Admin"),Z[X.PENDING_SUPPORT_ADMIN]=$("Support Admin"),Z[X.PENDING_MEMBER]=$("Member"),Z[X.TEAM_ADMIN]=$("Team Admin"),Z[X.ACCOUNTS_ADMIN]=$("User Management Admin"),Z[X.SUPPORT_ADMIN]=$("Support Admin"),Z[X.MEMBER]=$("Member"),Z[X.SUSPENDED]=$("Suspended"),Z[X.REMOVED]=$("Removed"),ee=function(e,t){var s,n,a;n={};for(a in e)s=e[a],n[a]=s.bind(t);return n},ae=function(e){return e.team_join_state===W.ACTIVE},Q=t.createClass({displayName:"TeamPage",propTypes:{members:oe.array,total:oe.number,numJoinRequests:oe.number,teamName:oe.string,teamFullName:oe.string,teamDomain:oe.string,teamFolderPathName:oe.string,teamRequestMembershipPolicy:oe.number,isLimitedTeam:oe.bool,notesLinkPolicy:oe.number,canInviteMembers:oe.bool,canManageTeamMembership:oe.bool,canSuggestMembers:oe.bool,canAccessAdminConsole:oe.bool,canDeleteTeam:oe.bool,canChangeTeamName:oe.bool,canSetTeamRequestMembershipPolicy:oe.bool,canSetNotesLinkPolicy:oe.bool,canHaveLimitedAdminSettings:oe.bool,canManageLimitedAdmins:oe.bool,viewerIsSoleAdmin:oe.bool,hasSettingsDialog:oe.bool,inviteMemberEmails:oe.arrayOf(oe.string),suggestedMembers:oe.arrayOf(oe.suggestedMember),openInviteModal:oe.bool,openSettingsModal:oe.bool,openUploadModal:oe.bool,onboardingModalVariant:oe.string,openInviteAndSettingsModal:oe.bool,pendingPersonalEmail:oe.string,adminOnboardingState:oe.number,teamMembersLimit:oe.number,enableMaxSizeExperiment:oe.bool,showCdmMveUi:oe.bool,showUpsellVariant:oe.string,viewer:oe.instanceOf(L),installPageInformation:oe.object,hasSeenClientInstallUi:oe.bool},getDefaultProps:function(){return{viewer:L.get_viewer(),hasSeenClientInstallUi:!0}},getInitialState:function(){return{totalMembersListLength:this.props.total,numJoinRequests:this.props.numJoinRequests,visibleMembers:this.props.members}},columnTypes:{displayName:function(e){return{field:"display_name_lower",header:$("Name"),classes:{"display-name-column":!0},width:e,render:function(e){return function(e){return ne.span({},te(f,{dimension:24,photoUrl:e.account_photo_url,optionalClass:"u-mar-right-xs",defaultAvatar:te(_,{dimension:24,initials:r.getInitials(e.display_name||e.email),color:ae(e)?se(e.display_name):"#aaa",shape:"CIRCLE",optionalClass:"u-mar-right-xs"})}),ne.span({className:"user-name"},e.display_name||$("Invited")),ne.span({className:"user-email"},e.email))}}(this)}},userType:function(e){return{field:"user_type",header:$("Status"),width:e,render:function(e){return function(t){return ne.span({className:"member-user-type"},function(){if(!this.props.isLimitedTeam)return Z[t.user_type];if(t.is_admin)return $("Admin");if(t.join_request_status)switch(t.join_request_status){case j.PENDING:return $("Requested Membership");case j.APPROVED:return $("Approved")}else switch(t.team_join_state){case W.ACTIVE:return $("Member");case W.PENDING:return $("Invited");case W.SUSPENDED:return $("Suspended");case W.REMOVED:return $("Removed");default:return $("Invalid")}}.call(e))}}(this)}},storageUsed:function(e){return{field:"storage_used",header:$("Usage"),width:e,initialSortDir:g.DESC_DIR,render:function(e){return function(t){var s,n;return n=t.storage_used||"-",s="",e.props.showCdmMveUi&&t.storage_used&&(s=w.calculateQuotaClass(t.used_raw_bytes/t.quota_raw_bytes),n=$("%(usage)s / %(user_quota)s").format({usage:n,user_quota:t.quota})),ne.span({className:s},n)}}(this)}},approveUser:function(e){return{width:e,classes:{"approve-request-column":!0},render:function(e){return function(t){var s;return s=t.join_request_status===j.PENDING,s&&e.props.canManageTeamMembership?te(O,{handler:e.onApproveRequest.bind(e,t)},te(v.button,{className:"button-primary action-button approve-button"},$("Approve"))):""}}(this)}},adminManagement:function(e){return{width:e,classes:{"limited-admin-management-col":!0},render:function(e){return function(t){return e.props.canHaveLimitedAdminSettings?e.adminGear(t):e.removeUserButton(t)}}(this)}},joinedDate:function(e){return{field:"team_joined_utc_ts",header:$("Joined"),width:e,render:function(e){return function(e){return e.joined||"—"}}(this)}}},adminGear:function(e){var t,s;return t=ne.button({className:"limited-admin-settings-button"},te(p,{group:"web",name:"gear",alt:$("Member settings")})),s=[],e.user_id===this.props.viewer.work_user.id?this.props.canManageLimitedAdmins&&s.push(te(U,{onClick:this.onRemoveAdminPermission.bind(this,e)},$("Remove my admin permissions"))):(this.props.canManageTeamMembership&&s.push(te(U,{onClick:this.onRemoveMember.bind(this,e)},$("Remove team member"))),this.props.canManageLimitedAdmins&&ae(e)&&(e.is_admin?s.push(te(U,{onClick:this.onRemoveAdminPermission.bind(this,e)},$("Remove admin permissions"))):s.push(te(U,{onClick:this.onGiveAdminPermission.bind(this,e)},$("Give admin permissions"))))),te(q,{arrow_position:"top-right",targetButton:t,items:s,vertical_displacement:8,horizontal_displacement:0})},removeUserButton:function(e){return e.user_id!==this.props.viewer.work_user.id&&this.props.canManageTeamMembership?ne.a({className:"remove-user-button",onClick:this.onRemoveMember.bind(this,e)},ne.img({src:"/static/images/x-vflYKfRuL.png"})):""},componentWillMount:function(){return this.columnTypes=ee(this.columnTypes,this)},componentDidMount:function(){return this.props.openInviteModal?this.showInviteModal(this.props.inviteMemberEmails):this.props.openSettingsModal?this.showSettingsModal():"NONE"!==this.props.onboardingModalVariant?this.showUploadModal():this.props.openInviteAndSettingsModal?this.showInviteAndSettingsModal():void 0},showUploadModal:function(){return this.refs["upload-manager"].showIntroModal()},renderMemberTable:function(){var e,t,s;return e=this.props.showCdmMveUi?[120,140]:[90,170],t=e[0],s=e[1],te(g,{ref:"members",columns:this.props.isLimitedTeam?[this.columnTypes.displayName(390),this.columnTypes.userType(s),this.columnTypes.storageUsed(t),this.columnTypes.approveUser(98),this.columnTypes.adminManagement(50)]:[this.columnTypes.displayName(400),this.columnTypes.userType(200),this.columnTypes.joinedDate(200)],initialData:{rows:this.props.members,total:this.props.total},initialSortColumn:1,emptyMessage:$("No members here"),rowsPerPage:20,classes:{"grey-style":!0},onRequestData:function(e){return function(t,s){return i.WebRequest({url:"/team/manage/list",data:{offset:t.offset,limit:t.limit,sort_column:t.sortColumn,sort_direction:t.sortDir},success:function(t){return t=JSON.parse(t),s(null,{rows:t.members,total:t.total}),e.onTeamMembersUpdated(t.members,t.total,t.num_join_requests)}})}}(this)})},onRemoveMember:function(e){return e.user_id===this.props.viewer.work_user.id?z.showInstance(te(F,{teamName:this.props.teamName})):e.join_request_status===j.PENDING?i.WebRequest({url:"/team/join_request/reject",data:{user_id:e.user_id},success:function(e){return function(){return a.success($("Membership request removed.")),e.refs.members.forceRefresh()}}(this)}):z.showInstance(te(Y,{teamName:this.props.teamName,showUpsellVariant:this.props.showUpsellVariant,user:e,onRemoved:function(e){return function(){return s.reload()}}(this)}))},onGiveAdminPermission:function(e){return z.showInstance(te(B,{targetUser:e,teamId:this.props.viewer.team_id,onSuccess:function(){return s.reload()}}))},onRemoveAdminPermission:function(e){var t;return this.props.viewerIsSoleAdmin?z.showInstance(te(J)):(t=this.props.viewer.work_user.id===e.user_id,z.showInstance(te(V,{targetUser:e,teamId:this.props.viewer.team_id,removingOwnPermissions:t,onSuccess:function(){return s.reload()}})))},onApproveRequest:function(e){return this.shouldShowMaxTeamSizeModal()?void this.showMaxTeamSizeModal():i.WebRequest({url:"/team/join_request/approve",data:{user_id:e.user_id},success:function(e){return function(){return a.success($("Membership approved.")),e.refs.members.forceRefresh()}}(this)})},onInviteClicked:function(){return K.log("clicked_invite_members_cta",{},null,null,!1,K.LOG_CATEGORY.TEAM_INFO),this.shouldShowMaxTeamSizeModal()?(this.props.canHaveLimitedAdminSettings||i.WebRequest({url:"/team/notify_admins_member_attempted_invite"}),this.showMaxTeamSizeModal()):this.showInviteModal()},onSuggestMembersClicked:function(){return K.log("clicked_suggest_members_cta"),z.showInstance(te(A))},onUpdateSettingsClicked:function(){return this.showSettingsModal()},showMaxTeamSizeModal:function(){var e;return e={team_id:this.props.viewer.team_id,member_type:this.props.canHaveLimitedAdminSettings?"admin":"non-admin",max_size:this.props.teamMembersLimit},K.log("teams_seen_size_upsell",e,null,this.props.viewer.work_user.id),z.showInstance(te(I,{showAdminVersion:this.props.canHaveLimitedAdminSettings,teamMembersLimit:this.props.teamMembersLimit,contacts:this.state.visibleMembers.filter(function(e){return null!=e.team_join_state})}))},showInviteModal:function(e){var t;return null==e&&(e=[]),this.props.isLimitedTeam?z.showInstance(te(N,{onInvited:function(e){return function(){return e.refs.members.forceRefresh()}}(this),populatedContacts:e.map(function(e){return new G({type:m.EMAIL,email:e})}),memberInviteLimit:this.props.enableMaxSizeExperiment?this.numRemainingInvites():null,maxTeamSize:this.props.teamMembersLimit})):(t={},e.length>0&&btoa?t.invite_emails=btoa(e.join(",")):t.show_invite_members=1,s.redirect(o({path:"/team/admin/members",query:t})))},showSettingsModal:function(){return z.showInstance(te(T,{canChangeTeamName:this.props.canChangeTeamName,canDeleteTeam:this.props.canDeleteTeam,canSetTeamRequestMembershipPolicy:this.props.canSetTeamRequestMembershipPolicy,canChangeNotesLinkPolicy:this.props.canSetNotesLinkPolicy,teamDomain:this.props.teamDomain,teamId:this.props.viewer.team_id,initialTeamName:this.props.teamName,initialTeamFullName:this.props.teamFullName,initialTeamRequestMembershipPolicy:this.props.teamRequestMembershipPolicy,initialNotesLinkPolicy:this.props.notesLinkPolicy}))},showInviteAndSettingsModal:function(){return z.showInstance(te(M,{initialTeamRequestMembershipPolicy:this.props.teamRequestMembershipPolicy,canSetTeamRequestMembershipPolicy:this.props.canSetTeamRequestMembershipPolicy,memberInviteLimit:this.props.enableMaxSizeExperiment?this.numRemainingInvites():null,maxTeamSize:this.props.teamMembersLimit,onInvited:function(e){return function(){return e.refs.members.forceRefresh()}}(this),onDismissCompleted:this.onInviteAndSettingsModalDismissed,suggested_contacts:this.props.suggestedMembers.map(function(e){return new G({dbx_account_id:e.avatar_url&&e.id,type:m.EMAIL,name:e.display_name,email:e.email,photo_url:e.avatar_url})})}))},onInviteAndSettingsModalDismissed:function(e){return e?s.redirect("/team"):this.showAccountPairSuggestModal()},showAccountPairSuggestModal:function(){return this.props.pendingPersonalEmail?z.showInstance(te(k,{suggested_email:this.props.pendingPersonalEmail,current_email:this.props.viewer.work_user.email,cont:"/team"})):void 0},onTeamMembersUpdated:function(e,t,s){return this.setState({totalMembersListLength:t,numJoinRequests:s,visibleMembers:e}),this.shouldShowMaxTeamSizeModal()?this.showMaxTeamSizeModal():void 0},shouldShowMaxTeamSizeModal:function(){return this.props.enableMaxSizeExperiment&&this.numRemainingInvites()<=0},numRemainingInvites:function(){return this.props.teamMembersLimit-(this.state.totalMembersListLength-this.state.numJoinRequests)},render:function(){return ne.div({className:"members-page"},ne.div({className:"page-heading-buttons"},this.props.canInviteMembers?ne.button({className:"button-primary action-button invite-button",onClick:this.onInviteClicked},$("Invite members")):this.props.canSuggestMembers?ne.button({className:"button-primary action-button",onClick:this.onSuggestMembersClicked},$("Suggest team members")):void 0,this.props.hasSettingsDialog?ne.button({className:"button-tertiary action-button settings-button",onClick:this.onUpdateSettingsClicked},$("Settings")):void 0,this.props.canAccessAdminConsole?ne.button({className:"button-tertiary action-button",onClick:function(){return s.redirect("/team/admin/members")}},$("Manage")):void 0),ne.div({className:"page-description"},$("All your %(team_name)s team members.").format({team_name:this.props.teamName})),this.renderMemberTable(),ne.div({className:"upload-manager"},te(H,{ref:"upload-manager",path:this.props.teamFolderPathName,initialOnboardingState:this.props.adminOnboardingState,installPageInformation:this.props.installPageInformation,showDesktopClientInstallModal:!this.props.hasSeenClientInstallUi,modalVariant:this.props.onboardingModalVariant})))}}),{TeamPage:Q}})}.call(this);
//# sourceMappingURL=pkg-aj.min.js-vflkxv6oS.map